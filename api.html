
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>API &#8212; DeepQMC 1.2.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/katex-math.css?v=91adb8b6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=6efca38a"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/katex.min.js?v=be8ff15f"></script>
    <script src="_static/auto-render.min.js?v=ad136472"></script>
    <script src="_static/katex_autorenderer.js?v=bebc588a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="refs.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
  
    <p class="title logo__title">DeepQMC 1.2.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="cli.html">
    Command-line interface
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="tutorial.html">
    Tutorial
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="refs.html">
    References
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/deepqmc/deepqmc" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="installation.html">
    Installation
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="cli.html">
    Command-line interface
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="tutorial.html">
    Tutorial
  </a>
</li>


<li class="nav-item current active">
  <a class="nav-link nav-internal" href="#">
    API
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="refs.html">
    References
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/deepqmc/deepqmc" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#haiku">Haiku</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#training-and-evaluation">Training and evaluation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling">Sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-deepqmc.optimizer">Optimizers</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wave-functions">Wave functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-neural-networks">Graph neural networks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphs">Graphs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electron-gnn">Electron GNN</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#excited-electronic-states">Excited electronic states</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#custom-data-types-and-type-aliases">Custom data types and type aliases</a></li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">API</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="id1">
<h1>API<a class="headerlink" href="#id1" title="Link to this heading">#</a></h1>
<p>This is the documentation of the API of the <code class="xref py py-class docutils literal notranslate"><span class="pre">deepqmc</span></code> package.</p>
<p>This implementation uses the <a class="reference external" href="https://github.com/google/jax">JAX library</a>, the documentation for which can be found here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jax.readthedocs.io/en/latest">JAX documentation</a></p></li>
</ul>
<dl class="py class" id="module-deepqmc.molecule">
<dt class="sig sig-object py" id="deepqmc.molecule.Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.molecule.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bohr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.molecule.Molecule" title="Link to this definition">#</a></dt>
<dd><p>Represents a molecule.</p>
<p>The array-like arguments accept anything that can be transformed to
<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">jax.Array</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – nuclear coordinates ((<span class="math">\(N_\text{nuc}\)</span>, 3), a.u.) as rows</p></li>
<li><p><strong>charges</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – atom charges (<span class="math">\(N_\text{nuc}\)</span>)</p></li>
<li><p><strong>charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – total charge of a molecule</p></li>
<li><p><strong>spin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – total spin multiplicity</p></li>
<li><p><strong>unit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – units of the coordinates, either ‘bohr’ or ‘angstrom’</p></li>
<li><p><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – additional data stored with the molecule</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.molecule.Molecule.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/molecule.html#Molecule.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.molecule.Molecule.from_file" title="Link to this definition">#</a></dt>
<dd><p>Create a molecule from a YAML file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – path to the YAML file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.molecule.Molecule.from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/molecule.html#Molecule.from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.molecule.Molecule.from_name" title="Link to this definition">#</a></dt>
<dd><p>Create a molecule from a database of named molecules.</p>
<p>The available names are in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.all_names</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – name of the molecule (one of <code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.all_names</span></code>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-deepqmc.hamil">
<dt class="sig sig-object py" id="deepqmc.hamil.LaplacianFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hamil.</span></span><span class="sig-name descname"><span class="pre">LaplacianFactory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil.html#LaplacianFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.LaplacianFactory" title="Link to this definition">#</a></dt>
<dd><p>Protocol class for Laplacian factories.</p>
<p>A Laplacian factory takes as input a function and returns a function that
computes the laplacian and gradient of the input function</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hamil.MolecularHamiltonian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hamil.</span></span><span class="sig-name descname"><span class="pre">MolecularHamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecp_type=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ecp_mask=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_std=1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">laplacian_factory=&lt;function</span> <span class="pre">laplacian&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil.html#MolecularHamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.MolecularHamiltonian" title="Link to this definition">#</a></dt>
<dd><p>Hamiltonian of non-relativistic molecular systems.</p>
<p>The system consists of nuclei with fixed positions and electrons moving
around them. The total energy is defined as the sum of the nuclear-nuclear
and electron-electron repulsion, the nuclear-electron attraction, and the
kinetic energy of the electrons:
<span class="math">\(E=V_\text{nuc-nuc} + V_\text{el-el} + V_\text{nuc-el} + E_\text{kin}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<a class="reference internal" href="#deepqmc.molecule.Molecule" title="deepqmc.molecule.Molecule"><em>Molecule</em></a>) – the molecule to consider</p></li>
<li><p><strong>ecp_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – If set, use the appropriate effective core potential (ECP). The
string is passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">pyscf.gto.M()</span></code> as <code class="xref py py-data docutils literal notranslate"><span class="pre">'ecp'</span></code> argument.
Supports ECPs that are implemented in the pyscf package, e.g. <code class="xref py py-data docutils literal notranslate"><span class="pre">'bfd'</span></code>
[Burkatzki et al. 2007] or <code class="xref py py-data docutils literal notranslate"><span class="pre">'ccECP'</span></code> [Bennett et al. 2017].</p></li>
<li><p><strong>ecp_mask</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>]</em>) – list of True and False values (<span class="math">\(N_\text{nuc}\)</span>)
specifying whether to use an ECP for each nucleus.</p></li>
<li><p><strong>elec_std</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – optional, a default value of the scaling factor
of the spread of electrons around the nuclei.</p></li>
<li><p><strong>laplacian_factory</strong> (<a class="reference internal" href="#deepqmc.hamil.LaplacianFactory" title="deepqmc.hamil.LaplacianFactory"><em>LaplacianFactory</em></a>) – creates a function that
returns a tuple containing the laplacian and gradient of the wave function.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.hamil.MolecularHamiltonian.as_pyscf">
<span class="sig-name descname"><span class="pre">as_pyscf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil.html#MolecularHamiltonian.as_pyscf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.MolecularHamiltonian.as_pyscf" title="Link to this definition">#</a></dt>
<dd><p>Return the hamiltonian parameters in format pyscf can parse.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coords</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – optional, nuclear coordinates (<span class="math">\(N_\text{nuc}\)</span>, 3).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.hamil.MolecularHamiltonian.init_sample">
<span class="sig-name descname"><span class="pre">init_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil.html#MolecularHamiltonian.init_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.MolecularHamiltonian.init_sample" title="Link to this definition">#</a></dt>
<dd><p>Guess some initial electron positions.</p>
<p>Tries to make an educated guess about plausible initial electron
configurations. Places electrons according to normal distributions
centered on the nuclei. If the molecule is not neutral, extra electrons
are placed on or removed from random nuclei. The resulting configurations
are usually very crude, a subsequent, thorough equilibration is needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>KeyArray</em>) – key used for PRNG.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – nuclear coordinates of a single molecular geometry
(<span class="math">\(N_\text{nuc}\)</span>, 3)</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of initial electron configurations to generate.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>initial electron and nuclei</dt><dd><p>configurations</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deepqmc.types.PhysicalConfiguration" title="deepqmc.types.PhysicalConfiguration"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalConfiguration</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="haiku">
<h2>Haiku<a class="headerlink" href="#haiku" title="Link to this heading">#</a></h2>
<p>The JAX implementation uses the <a class="reference external" href="https://github.com/deepmind/dm-haiku">haiku library</a> to create, train and evaluate neural network models.
Some additional neural network functionality is implemented in the package and documented here.</p>
<dl class="py class" id="module-deepqmc.hkext">
<dt class="sig sig-object py" id="deepqmc.hkext.GLU">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">GLU</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#GLU"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.GLU" title="Link to this definition">#</a></dt>
<dd><p>Gated Linear Unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the output dimension.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – optional, the name of the network.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – optional, whether to include a bias term.</p></li>
<li><p><strong>layer_norm_before</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – optional, whether to apply layer normalization before
the GLU operation.</p></li>
<li><p><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – default is sigmoid, the activation
function.</p></li>
<li><p><strong>b_init</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – default is zeros, the initialization
function for the bias term.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.Identity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">Identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#Identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.Identity" title="Link to this definition">#</a></dt>
<dd><p>Represent the identity operation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.MLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.MLP" title="Link to this definition">#</a></dt>
<dd><p>Represent a multilayer perceptron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the output dimension.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – optional, the name of the network.</p></li>
<li><p><strong>hidden_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><em>tuple</em></a>) – optional, either (‘log’, <span class="math">\(N_\text{layers}\)</span>),
in which case the network will have <span class="math">\(N_\text{layers}\)</span> layers
with logarithmically changing widths, or a tuple of ints specifying
the width of each layer.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>optional, specifies which layers should have a bias term.
Possible values are</p>
<ul>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a>: all layers will have a bias term</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>: no layers will have a bias term</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'not_last'</span></code>: all but the last layer will have a bias term</p></li>
</ul>
</p></li>
<li><p><strong>last_linear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – optional, if <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a> the activation function
is not applied to the activation of the last layer.</p></li>
<li><p><strong>activation</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – optional, the activation function.</p></li>
<li><p><strong>init</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>Callable</em>) – <p>optional, specifies the initialization of the
linear weights. Possible string values are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code>: the default haiku initialization method is used.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'ferminet'</span></code>: the initialization method of the <code class="xref py py-class docutils literal notranslate"><span class="pre">ferminet</span></code></dt><dd><p>package is used.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'deeperwin'</span></code>: the initialization method of the <code class="xref py py-class docutils literal notranslate"><span class="pre">deeperwin</span></code></dt><dd><p>package is used.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.ResidualConnection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">ResidualConnection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#ResidualConnection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.ResidualConnection" title="Link to this definition">#</a></dt>
<dd><p>Represent a residual connection between pytrees.</p>
<p>The residual connection is only added if <code class="xref py py-data docutils literal notranslate"><span class="pre">inp</span></code> and <code class="xref py py-data docutils literal notranslate"><span class="pre">update</span></code>
have the same shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>normalize</strong> (<em>-</em>) – if <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a> the sum of <code class="xref py py-data docutils literal notranslate"><span class="pre">inp</span></code> and <code class="xref py py-data docutils literal notranslate"><span class="pre">update</span></code>
is normalized with <code class="xref py py-data docutils literal notranslate"><span class="pre">sqrt(2)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.SumPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">SumPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#SumPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.SumPool" title="Link to this definition">#</a></dt>
<dd><p>Represent a global sum pooling operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the output dimension.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – optional, the name of the network.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.hkext.ssp">
<span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">ssp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#ssp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.ssp" title="Link to this definition">#</a></dt>
<dd><p>Compute the shifted softplus activation function.</p>
<p>Computes the elementwise function
<span class="math">\(\text{softplus}(x)=\log(1+\text{e}^x)+\log\frac{1}{2}\)</span></p>
</dd></dl>

</section>
<section id="training-and-evaluation">
<h2>Training and evaluation<a class="headerlink" href="#training-and-evaluation" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.types.TrainState">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">TrainState</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/types.html#TrainState"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.types.TrainState" title="Link to this definition">#</a></dt>
<dd><p>Represent the current state of the training.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.TrainState.opt">
<span class="sig-name descname"><span class="pre">opt</span></span><a class="headerlink" href="#deepqmc.types.TrainState.opt" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.TrainState.params">
<span class="sig-name descname"><span class="pre">params</span></span><a class="headerlink" href="#deepqmc.types.TrainState.params" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.TrainState.sampler">
<span class="sig-name descname"><span class="pre">sampler</span></span><a class="headerlink" href="#deepqmc.types.TrainState.sampler" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py function" id="module-deepqmc.train">
<dt class="sig sig-object py" id="deepqmc.train.train">
<span class="sig-prename descclassname"><span class="pre">deepqmc.train.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ansatz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electron_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecule_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electronic_states</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_restarts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_eq_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eq_allow_early_stopping</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrain_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrain_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkpt_constructor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_logger_constructor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h5_logger_constructor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_function_factory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observable_monitors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/train.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.train.train" title="Link to this definition">#</a></dt>
<dd><p>Train or evaluate a JAX wave function model.</p>
<p>It initializes and equilibrates the MCMC sampling of the wave function ansatz,
then optimizes or samples it using the variational principle. It optionally
saves checkpoints and rewinds the training/evaluation if an error is encountered.
If an optimizer is supplied, the Ansatz is optimized, otherwise the Ansatz is
only sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<a class="reference internal" href="#deepqmc.hamil.MolecularHamiltonian" title="deepqmc.hamil.MolecularHamiltonian"><em>MolecularHamiltonian</em></a>) – the Hamiltonian of the
physical system.</p></li>
<li><p><strong>ansatz</strong> (<a class="reference internal" href="#deepqmc.types.Ansatz" title="deepqmc.types.Ansatz"><em>Ansatz</em></a>) – the wave function Ansatz.</p></li>
<li><p><strong>opt</strong> (<code class="docutils literal notranslate"><span class="pre">kfac_jax</span></code> or <code class="docutils literal notranslate"><span class="pre">optax</span></code> optimizers | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>) – <p>the optimizer. Possible values are:</p>
<ul>
<li><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">kfac_jax.Optimizer</span></code>:</dt><dd><p>the partially initialized KFAC optimizer is used</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>an <code class="xref py py-data docutils literal notranslate"><span class="pre">optax</span></code> optimizer instance:</dt><dd><p>the supplied <code class="xref py py-data docutils literal notranslate"><span class="pre">optax</span></code> optimizer is used.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>:</dt><dd><p>no optimizer is used, e.g. the evaluation of the Ansatz is performed.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>sampler_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – a function that returns a Sampler
instance</p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of optimization steps.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the seed used for PRNG.</p></li>
<li><p><strong>electron_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of electron samples considered in a batch</p></li>
<li><p><strong>molecule_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, the number of molecules considered in a
batch. Only needed for transferable training.</p></li>
<li><p><strong>electronic_states</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, the number of electronic states to consider.</p></li>
<li><p><strong>mols</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="#deepqmc.molecule.Molecule" title="deepqmc.molecule.Molecule"><em>Molecule</em></a><em>]</em>) – optional, a sequence of molecules
to consider for transferable training. If None the default molecule from
hamil is used.</p></li>
<li><p><strong>workdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – optional, path, where results should be saved.</p></li>
<li><p><strong>train_state</strong> (<a class="reference internal" href="#deepqmc.types.TrainState" title="deepqmc.types.TrainState"><em>TrainState</em></a>) – optional, training checkpoint to
restore training or run evaluation.</p></li>
<li><p><strong>init_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, initial step index, useful if
calculation is restarted from checkpoint saved on disk.</p></li>
<li><p><strong>max_restarts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, the maximum number of times the training is
retried before a <code class="xref py py-class docutils literal notranslate"><span class="pre">NaNError</span></code> is raised.</p></li>
<li><p><strong>max_eq_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, maximum number of equilibration steps if not
detected earlier.</p></li>
<li><p><strong>eq_allow_early_stopping</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – default <code class="docutils literal notranslate"><span class="pre">True</span></code>, whether to allow the
equilibration to stop early when the equilibration criterion has been met.</p></li>
<li><p><strong>pretrain_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, the number of pretraining steps wrt. to the
Baseline wave function obtained with pyscf.</p></li>
<li><p><strong>pretrain_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – optional, extra arguments for pretraining.</p></li>
<li><p><strong>chkpt_constructor</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><em>CheckpointStore</em><em>]</em>) – optional, an
object that saves training checkpoints to the working directory.</p></li>
<li><p><strong>metric_logger_constructor</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><em>MetricLogger</em><em>]</em>) – optional,
an object that consumes metric logging information. If not specified, the
default <code class="xref py py-class docutils literal notranslate"><span class="pre">TensorboardMetricLogger</span></code> is used to create
tensorboard logs.</p></li>
<li><p><strong>h5_logger_constructor</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><em>H5Logger</em><em>]</em>) – optional, an object
that consumes metric logging information. If not specified, the default
<code class="xref py py-class docutils literal notranslate"><span class="pre">H5Logger</span></code> is used to write comprehensive training
statistics to an h5file.</p></li>
<li><p><strong>merge_keys</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – optional, list of strings for selecting parameters to be
shared across electronic states. Matching merge keys with (substrings of)
parameter keys.</p></li>
<li><p><strong>loss_function_factory</strong> (<em>LossFunctionFactory</em>) – optional, a callable returning a suitable loss function for the
optimization.</p></li>
<li><p><strong>observable_monitors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><em>ObservableMonitor</em><em>]</em>) – optional,
list of observable monitors to be evaluated during training or evaluation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="sampling">
<span id="module-deepqmc.fit"></span><h2>Sampling<a class="headerlink" href="#sampling" title="Link to this heading">#</a></h2>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.SamplerState">
<span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">SamplerState</span></span><a class="headerlink" href="#deepqmc.types.SamplerState" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.base.ElectronSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.base.</span></span><span class="sig-name descname"><span class="pre">ElectronSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/base.html#ElectronSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.base.ElectronSampler" title="Link to this definition">#</a></dt>
<dd><p>Protocol for <a class="reference internal" href="#deepqmc.sampling.base.ElectronSampler" title="deepqmc.sampling.base.ElectronSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronSampler</span></code></a> objects.</p>
<p><a class="reference internal" href="#deepqmc.sampling.base.ElectronSampler" title="deepqmc.sampling.base.ElectronSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronSampler</span></code></a> objects implement Markov chain
samplers for the electron positions. The samplers are assumed to implement a batch
of walkers for a single electronic state on a single molecule and may be vmapped
to fit the respective context they are used in. Electron samplers can be combined
with <a class="reference internal" href="#deepqmc.sampling.chain" title="deepqmc.sampling.chain"><code class="xref py py-func docutils literal notranslate"><span class="pre">chain()</span></code></a>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.sampling.base.ElectronSampler.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/base.html#ElectronSampler.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.base.ElectronSampler.init" title="Link to this definition">#</a></dt>
<dd><p>Initializes the sampler state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>KeyArray</em>) – an rng key for the initialization of electron
positions.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – the parameters of the wave function that is
being sampled.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of walkers to propagate in parallel.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the nuclei positions of the molecular configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the sampler state holding electron
positions and data about the sampler trajectory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deepqmc.types.SamplerState" title="deepqmc.types.SamplerState"><code class="xref py py-type docutils literal notranslate"><span class="pre">SamplerState</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.sampling.base.ElectronSampler.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/base.html#ElectronSampler.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.base.ElectronSampler.sample" title="Link to this definition">#</a></dt>
<dd><p>Propagates the sampler state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>KeyArray</em>) – an rng key for the proposal of electron
positions.</p></li>
<li><p><strong>state</strong> (<em>SamplerState</em>) – the state of the sampler from the
previous step.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – the parameters of the wave function that is
being sampled.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the nuclei positions of the molecular configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[<a class="reference internal" href="#deepqmc.types.SamplerState" title="deepqmc.types.SamplerState"><code class="xref py py-type docutils literal notranslate"><span class="pre">SamplerState</span></code></a>,
<a class="reference internal" href="#deepqmc.types.PhysicalConfiguration" title="deepqmc.types.PhysicalConfiguration"><code class="xref py py-type docutils literal notranslate"><span class="pre">PhysicalConfiguration</span></code></a>, <a class="reference internal" href="#deepqmc.types.Stats" title="deepqmc.types.Stats"><code class="xref py py-type docutils literal notranslate"><span class="pre">Stats</span></code></a>]:
the new sampler state, a physical configuration and statistics about the
sampling trajectory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.sampling.base.ElectronSampler.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/base.html#ElectronSampler.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.base.ElectronSampler.update" title="Link to this definition">#</a></dt>
<dd><p>Updates the sampler state.</p>
<p>The sampler state is updated to account for changes in the wave function due
to a parameter update.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>SamplerState</em>) – the state of the sampler before
parameter update.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – the new parameters of the wave function.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the nuclei positions of the molecular configuration.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the updated sampler state holding
electron positions and data about the sampler trajectory.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deepqmc.types.SamplerState" title="deepqmc.types.SamplerState"><code class="xref py py-type docutils literal notranslate"><span class="pre">SamplerState</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-deepqmc.sampling">
<dt class="sig sig-object py" id="deepqmc.sampling.DecorrSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">DecorrSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/electron_samplers.html#DecorrSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.DecorrSampler" title="Link to this definition">#</a></dt>
<dd><p>Insert decorrelating steps into chained samplers.</p>
<p>This sampler cannot be used as the last element of a sampler chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the samples will be taken in every <code class="xref py py-data docutils literal notranslate"><span class="pre">length</span></code> MCMC step,
that is, <code class="xref py py-data docutils literal notranslate"><span class="pre">length</span></code> <span class="math">\(-1\)</span> decorrelating steps are inserted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.LangevinSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">LangevinSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/electron_samplers.html#LangevinSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.LangevinSampler" title="Link to this definition">#</a></dt>
<dd><p>Metropolis adjusted Langevin Monte Carlo sampler.</p>
<p>Derived from <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<a class="reference internal" href="#deepqmc.hamil.MolecularHamiltonian" title="deepqmc.hamil.MolecularHamiltonian"><em>MolecularHamiltonian</em></a>) – the Hamiltonian of the physical
system.</p></li>
<li><p><strong>wf</strong> – the <code class="xref py py-data docutils literal notranslate"><span class="pre">apply</span></code> method of the <code class="xref py py-data docutils literal notranslate"><span class="pre">haiku</span></code> transformed ansatz object.</p></li>
<li><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – optional, the proposal step size scaling factor. Adjusted during
every step if <code class="xref py py-data docutils literal notranslate"><span class="pre">target_acceptance</span></code> is specified.</p></li>
<li><p><strong>target_acceptance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – optional, if specified the proposal step size
will be scaled such that the ratio of accepted proposal steps approaches
<code class="xref py py-data docutils literal notranslate"><span class="pre">target_acceptance</span></code>.</p></li>
<li><p><strong>max_age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, if specified the next proposed step will always be
accepted for a walker that hasn’t moved in the last <code class="xref py py-data docutils literal notranslate"><span class="pre">max_age</span></code> steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.MetropolisSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">MetropolisSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/electron_samplers.html#MetropolisSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.MetropolisSampler" title="Link to this definition">#</a></dt>
<dd><p>Metropolis–Hastings Monte Carlo sampler.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code> method of this class returns electron coordinate samples
from the distribution defined by the square of the sampled wave function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<a class="reference internal" href="#deepqmc.hamil.MolecularHamiltonian" title="deepqmc.hamil.MolecularHamiltonian"><em>MolecularHamiltonian</em></a>) – the Hamiltonian of the physical
system.</p></li>
<li><p><strong>wf</strong> – the <code class="xref py py-data docutils literal notranslate"><span class="pre">apply</span></code> method of the <code class="xref py py-data docutils literal notranslate"><span class="pre">haiku</span></code> transformed ansatz object.</p></li>
<li><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – optional, the proposal step size scaling factor. Adjusted during
every step if <code class="xref py py-data docutils literal notranslate"><span class="pre">target_acceptance</span></code> is specified.</p></li>
<li><p><strong>target_acceptance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – optional, if specified the proposal step size
will be scaled such that the ratio of accepted proposal steps approaches
<code class="xref py py-data docutils literal notranslate"><span class="pre">target_acceptance</span></code>.</p></li>
<li><p><strong>max_age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, if specified the next proposed step will always be
accepted for a walker that hasn’t moved in the last <code class="xref py py-data docutils literal notranslate"><span class="pre">max_age</span></code> steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.MoleculeIdxSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">MoleculeIdxSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_mols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shuffle</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/combined_samplers.html#MoleculeIdxSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.MoleculeIdxSampler" title="Link to this definition">#</a></dt>
<dd><p>Sample molecule indexes for transferable training.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.MultiNuclearGeometrySampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">MultiNuclearGeometrySampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">elec_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuc_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warp_elec_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_nuc_period</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_equilibration_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/combined_samplers.html#MultiNuclearGeometrySampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.MultiNuclearGeometrySampler" title="Link to this definition">#</a></dt>
<dd><p>This sampler samples from multiple nuclear geometries in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>elec_sampler</strong> (<em>ElectronSampler</em>) – the electronic sampler to use</p></li>
<li><p><strong>nuc_sampler</strong> (<em>NucleiSampler</em>) – the nuclei
sampler to use.</p></li>
<li><p><strong>warp_elec_fn</strong> (<em>ElectronWarp</em>) – the function
that warps the electrons to the new nuclear geometry.</p></li>
<li><p><strong>update_nuc_period</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, the number of steps between nuclear updates.</p></li>
<li><p><strong>elec_equilibration_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, the number of steps to equilibrate the
electronic state after a nuclear update.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.ResampledSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">ResampledSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/electron_samplers.html#ResampledSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.ResampledSampler" title="Link to this definition">#</a></dt>
<dd><p>Add resampling to chained samplers.</p>
<p>This sampler cannot be used as the last element of a sampler chain.
The resampling is performed by accumulating weights on each MCMC walker
in each step. Based on a fixed resampling period <code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> and/or a
threshold <code class="xref py py-data docutils literal notranslate"><span class="pre">threshold</span></code> on the normalized effective sample size the walker
positions are sampled according to the multinomial distribution defined by
these weights, and the weights are reset to one. Either <code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> or
<code class="xref py py-data docutils literal notranslate"><span class="pre">threshold</span></code> have to be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>period</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – optional, if specified the walkers are resampled every
<code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> MCMC steps.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – optional, if specified the walkers are resampled if
the effective sample size normalized with the batch size is below
<code class="xref py py-data docutils literal notranslate"><span class="pre">threshold</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.sampling.chain">
<span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">samplers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/sampling_utils.html#chain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.chain" title="Link to this definition">#</a></dt>
<dd><p>Combine multiple sampler types, to create advanced sampling schemes.</p>
<p>For example <code class="xref py py-data docutils literal notranslate"><span class="pre">chain(DecorrSampler(10),MetropolisSampler(hamil,</span> <span class="pre">tau=1.))</span></code>
will create a <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a>, where the samples
are taken from every 10th MCMC step. The last element of the sampler chain has
to be either a <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a> or a <a class="reference internal" href="#deepqmc.sampling.LangevinSampler" title="deepqmc.sampling.LangevinSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">LangevinSampler</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samplers</strong> (<a class="reference internal" href="#deepqmc.sampling.base.ElectronSampler" title="deepqmc.sampling.base.ElectronSampler"><em>ElectronSampler</em></a>) – one or more sampler instances
to combine.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the combined sampler.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deepqmc.sampling.base.ElectronSampler" title="deepqmc.sampling.base.ElectronSampler"><code class="xref py py-type docutils literal notranslate"><span class="pre">ElectronSampler</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.sampling.combine_samplers">
<span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">combine_samplers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samplers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/sampling_utils.html#combine_samplers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.combine_samplers" title="Link to this definition">#</a></dt>
<dd><p>Combine samplers to create more advanced sampling schemes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samplers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="#deepqmc.sampling.base.ElectronSampler" title="deepqmc.sampling.base.ElectronSampler"><em>ElectronSampler</em></a><em>]</em>) – one or more sampler
instances to combine.</p></li>
<li><p><strong>hamil</strong> (<a class="reference internal" href="#deepqmc.hamil.MolecularHamiltonian" title="deepqmc.hamil.MolecularHamiltonian"><em>MolecularHamiltonian</em></a>) – the molecular Hamiltonian.</p></li>
<li><p><strong>wf</strong> (<em>ParametrizedWaveFunction</em>) – the wave function to sample.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-deepqmc.optimizer">
<span id="optimizers"></span><h2>Optimizers<a class="headerlink" href="#module-deepqmc.optimizer" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.optimizer.Optimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.optimizer.</span></span><span class="sig-name descname"><span class="pre">Optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss_and_grad_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">merge_keys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/optimizer.html#Optimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.optimizer.Optimizer" title="Link to this definition">#</a></dt>
<dd><p>Protocol for <a class="reference internal" href="#deepqmc.optimizer.Optimizer" title="deepqmc.optimizer.Optimizer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Optimizer</span></code></a> objects.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.optimizer.Optimizer.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/optimizer.html#Optimizer.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.optimizer.Optimizer.init" title="Link to this definition">#</a></dt>
<dd><p>Initialize the optimizer state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>KeyArray</em>) – the RNG key used to initialize random
components the of optimizer state.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – the parameters of the wave function
ansatz/ansatzes to be optimized during training.</p></li>
<li><p><strong>batch</strong> (<em>Batch</em>) – a tuple containing a physical configuration,
a set of sample weights and auxiliary data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the initial state of the optimizer</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>OptState</em></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.optimizer.Optimizer.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/optimizer.html#Optimizer.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.optimizer.Optimizer.step" title="Link to this definition">#</a></dt>
<dd><p>Perform an optimization step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>KeyArray</em>) – the RNG key for the optimizer update.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – the current parameters of the wave function
ansatz/ansatzes.</p></li>
<li><p><strong>opt_state</strong> (<em>OptState</em>) – the current state of the optimizer</p></li>
<li><p><strong>batch</strong> (<em>Batch</em>) – a tuple containing a physical configuration,
a set of sample weights and auxiliary data.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple[~deepqmc.types.Params, ~deepqmc.types.OptState, ~deepqmc.types.Energy,
jax.Array | None, ~deepqmc.types.Stats]: the new model
parameters, an updated optimizer state, the energies obtained during the
evaluation of the loss function, if applicable the wave function ratios
obtained during the evaluation of the loss dunction and further statistics.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="wave-functions">
<h2>Wave functions<a class="headerlink" href="#wave-functions" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.types.Psi">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">Psi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sign</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/types.html#Psi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.types.Psi" title="Link to this definition">#</a></dt>
<dd><p>Represent wave function values.</p>
<p>The sign and log of the absolute value of the wave function are stored.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.Psi.log">
<span class="sig-name descname"><span class="pre">log</span></span><a class="headerlink" href="#deepqmc.types.Psi.log" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.Psi.sign">
<span class="sig-name descname"><span class="pre">sign</span></span><a class="headerlink" href="#deepqmc.types.Psi.sign" title="Link to this definition">#</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.WaveFunction">
<span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">WaveFunction</span></span><a class="headerlink" href="#deepqmc.types.WaveFunction" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">pytree_dataclass</span></code>], <a class="reference internal" href="#deepqmc.types.Psi" title="deepqmc.types.Psi"><code class="xref py py-class docutils literal notranslate"><span class="pre">Psi</span></code></a>]</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.ParametrizedWaveFunction">
<span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">ParametrizedWaveFunction</span></span><a class="headerlink" href="#deepqmc.types.ParametrizedWaveFunction" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.MutableMapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableMapping</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">pytree_dataclass</span></code>], <a class="reference internal" href="#deepqmc.types.Psi" title="deepqmc.types.Psi"><code class="xref py py-class docutils literal notranslate"><span class="pre">Psi</span></code></a>]</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.types.Ansatz">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">Ansatz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/types.html#Ansatz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.types.Ansatz" title="Link to this definition">#</a></dt>
<dd><p>Protocol for ansatz objects.</p>
<p><a class="reference internal" href="#deepqmc.types.Ansatz" title="deepqmc.types.Ansatz"><code class="xref py py-class docutils literal notranslate"><span class="pre">Ansatz</span></code></a> objects represent a parametrized wave function
Ansatz. New types of Ansatzes should implement this protocol to be compatible with
the DeepQMC software suite. It is assumed that Ansatzes take as input a
<a class="reference internal" href="#deepqmc.types.PhysicalConfiguration" title="deepqmc.types.PhysicalConfiguration"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhysicalConfiguration</span></code></a> for a single sample of electron and
nuclei configuration. To handle batches of samples, e.g. during training, the Ansatz
is <code class="docutils literal notranslate"><span class="pre">vmap</span></code>-ed automatically by DeepQMC.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.types.Ansatz.apply">
<span class="sig-name descname"><span class="pre">apply</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys_conf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/types.html#Ansatz.apply"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.types.Ansatz.apply" title="Link to this definition">#</a></dt>
<dd><p>Evaluate the Ansatz.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<em>Params</em>) – the current parameters with which to
evaluate the Ansatz.</p></li>
<li><p><strong>phys_conf</strong> (<a class="reference internal" href="#deepqmc.types.PhysicalConfiguration" title="deepqmc.types.PhysicalConfiguration"><em>PhysicalConfiguration</em></a>) – a single sample on which
to evaluate the Ansatz.</p></li>
<li><p><strong>return_mos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to return the many-body orbitals instead of the
wave function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the value of the wave function.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deepqmc.types.Psi" title="deepqmc.types.Psi"><em>Psi</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.types.Ansatz.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys_conf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/types.html#Ansatz.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.types.Ansatz.init" title="Link to this definition">#</a></dt>
<dd><p>Initialize the parameters of the Ansatz.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>KeyArray</em>) – the RNG key used to generate the initial
parameters.</p></li>
<li><p><strong>phys_conf</strong> (<a class="reference internal" href="#deepqmc.types.PhysicalConfiguration" title="deepqmc.types.PhysicalConfiguration"><em>PhysicalConfiguration</em></a>) – a dummy input to the
network of a single electron and nuclei configuration. The value of
this can be anything, only its shape information is read.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the initial parameters of the Ansatz.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Params</em></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.wf.NeuralNetworkWaveFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.wf.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkWaveFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">omni_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backflow_op</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_determinants</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">full_determinant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cusp_electrons</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cusp_nuclei</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backflow_transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conf_coeff</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/nn_wave_function.html#NeuralNetworkWaveFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.wf.NeuralNetworkWaveFunction" title="Link to this definition">#</a></dt>
<dd><p>Implements the neural network wave function.</p>
<p>Configuration files to obtain the PauliNet <a class="reference internal" href="refs.html#hermannnc20" id="id2"><span>[HermannNC20]</span></a>, FermiNet <a class="reference internal" href="refs.html#pfauprr20" id="id3"><span>[PfauPRR20]</span></a>,
DeepErwin <a class="reference internal" href="refs.html#gerard22" id="id4"><span>[Gerard22]</span></a> and PsiFormer <a class="reference internal" href="refs.html#glehn22" id="id5"><span>[Glehn22]</span></a> architectures are provided. For a
detailed description of the implemented architecture see <a class="reference internal" href="refs.html#schaetzle23" id="id6"><span>[Schaetzle23]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<a class="reference internal" href="#deepqmc.hamil.MolecularHamiltonian" title="deepqmc.hamil.MolecularHamiltonian"><em>MolecularHamiltonian</em></a>) – the Hamiltonian of the system.</p></li>
<li><p><strong>omni_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – creates the omni net.</p></li>
<li><p><strong>envelope</strong> (<em>ExponentialEnvelopes</em>) – the orbital envelopes.</p></li>
<li><p><strong>backflow_op</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – specifies how the backflow is applied
to the orbitals.</p></li>
<li><p><strong>n_determinants</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – specifies the number of determinants</p></li>
<li><p><strong>full_determinant</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, the determinants are
factorized into spin-up and spin-down parts.</p></li>
<li><p><strong>cusp_electrons</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – constructor of the electronic cusp
module.</p></li>
<li><p><strong>cusp_nuclei</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – constructor of the nuclear cusp module.</p></li>
<li><p><strong>backflow_transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>describes the backflow transformation.
Possible values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mult'</span></code>: the backflow is a multiplicative factor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'add'</span></code>: the backflow is an additive term</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'both'</span></code>: the backflow consist of a multiplicative factor</dt><dd><p>and an additive term</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>conf_coeff</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – returns a function that combines the
determinants to obtain the WF value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="graph-neural-networks">
<span id="module-deepqmc.wf.nn_wave_function"></span><h2>Graph neural networks<a class="headerlink" href="#graph-neural-networks" title="Link to this heading">#</a></h2>
<p>A graph neural network is the most important component of the neural network wave function ansatz.
This module implements a general gnn framework, that can be configured to obtain a variety of different ansatzes.</p>
<section id="graphs">
<h3>Graphs<a class="headerlink" href="#graphs" title="Link to this heading">#</a></h3>
<p>This submodule implements the basic functionality for working with graphs.</p>
<dl class="py function" id="module-deepqmc.gnn.graph">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.GraphEdgeBuilder">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">GraphEdgeBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_self</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#GraphEdgeBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.GraphEdgeBuilder" title="Link to this definition">#</a></dt>
<dd><p>Create a function that builds graph edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mask_self</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to mask edges that begin and end in the same node.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.GraphUpdate">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">GraphUpdate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aggregate_edges_for_nodes_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_nodes_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_edges_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#GraphUpdate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.GraphUpdate" title="Link to this definition">#</a></dt>
<dd><p>Create a function that updates a graph.</p>
<p>The update function is tailored to be used in GNNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aggregate_edges_for_nodes_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to perform the aggregation
of edges for nodes.</p></li>
<li><p><strong>update_nodes_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – optional, function that updates the
nodes.</p></li>
<li><p><strong>update_edges_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – optional, function that updates the
edges.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.MolecularGraphEdgeBuilder">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">MolecularGraphEdgeBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_types</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#MolecularGraphEdgeBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.MolecularGraphEdgeBuilder" title="Link to this definition">#</a></dt>
<dd><p>Create a function that builds many types of molecular edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_nuc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of nuclei.</p></li>
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin-up electrons.</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin-down electrons.</p></li>
<li><p><strong>edge_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – <p>list of edge type names to build. Possible names are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'nn'</span></code>: nuclei-&gt;nuclei edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ne'</span></code>: nuclei-&gt;electrons edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'en'</span></code>: electrons-&gt;nuclei edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'same'</span></code>: edges between same-spin electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'anti'</span></code>: edges between opposite-spin electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'up'</span></code>: edges going from spin-up electrons to all electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'down'</span></code>: edges going from spin-down electrons to all electrons</p></li>
</ul>
</p></li>
<li><p><strong>self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether edges between a particle and itself are
considered</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-deepqmc.gnn.edge_features">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.CombinedEdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">CombinedEdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#CombinedEdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.CombinedEdgeFeature" title="Link to this definition">#</a></dt>
<dd><p>Combine multiple edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>features</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="#deepqmc.gnn.edge_features.EdgeFeature" title="deepqmc.gnn.edge_features.EdgeFeature"><em>EdgeFeature</em></a><em>]</em>) – a list of edge feature
objects to combine.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.DifferenceEdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">DifferenceEdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#DifferenceEdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.DifferenceEdgeFeature" title="Link to this definition">#</a></dt>
<dd><p>Return the difference vector as the edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>log_rescale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to rescale the features by
<span class="math">\(\log(1 + d) / d\)</span> where <span class="math">\(d\)</span> is the length of the edge.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.DistancePowerEdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">DistancePowerEdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#DistancePowerEdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.DistancePowerEdgeFeature" title="Link to this definition">#</a></dt>
<dd><p>Return powers of the distance as edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>powers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em>]</em>) – a <code class="xref py py-data docutils literal notranslate"><span class="pre">list</span></code> of powers to apply to the edge length.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a><em> | </em><em>None</em>) – a small value to add to the denominator when the power is
negative.</p></li>
<li><p><strong>log_rescale</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to rescale the features by
<span class="math">\(\log(1 + d) / d\)</span> where <span class="math">\(d\)</span> is the length of the edge.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.EdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">EdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#EdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.EdgeFeature" title="Link to this definition">#</a></dt>
<dd><p>Base class for all edge features.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.GaussianEdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">GaussianEdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gaussian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#GaussianEdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.GaussianEdgeFeature" title="Link to this definition">#</a></dt>
<dd><p>Expand the distance in a Gaussian basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_gaussian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of gaussians to use,
consequently the length of the feature vector</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>) – the radius within which to place gaussians</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to offset the position of the first
Gaussian from zero.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="electron-gnn">
<h3>Electron GNN<a class="headerlink" href="#electron-gnn" title="Link to this heading">#</a></h3>
<p>This submodule provides the ElectronGNN architecture for defining neural network
parametrized functions acting on graphs of electrons and nuclei.</p>
<dl class="py class" id="module-deepqmc.gnn.electron_gnn">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.ElectronEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.electron_gnn.</span></span><span class="sig-name descname"><span class="pre">ElectronEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_elec_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_types</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positional_embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_to_embedding_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#ElectronEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.ElectronEmbedding" title="Link to this definition">#</a></dt>
<dd><p>Create initial embeddings for electrons.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_nuc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of nuclei.</p></li>
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of spin up electrons.</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of spin down electrons.</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the desired length of the embedding vectors.</p></li>
<li><p><strong>n_elec_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – <p>the number of electron types to differentiate.
Usual values are:</p>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">1</span></code>: treat all electrons as indistinguishable. Note that electrons</dt><dd><p>with different spins can still become distinguishable during the later
embedding update steps of the GNN.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">2</span></code>: treat spin up and spin down electrons as distinguishable already</dt><dd><p>in the initial embeddings.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>elec_types</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – an integer array with length equal to the number of
electrons, with entries between <code class="docutils literal notranslate"><span class="pre">0</span></code> and <code class="docutils literal notranslate"><span class="pre">n_elec_types</span></code>. Specifies the
type for each electron.</p></li>
<li><p><strong>positional_embeddings</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – optional, if not <code class="docutils literal notranslate"><span class="pre">None</span></code>, a <code class="docutils literal notranslate"><span class="pre">dict</span></code> with edge
types as keys, and edge features as values. Specifies the edge types and
edge features to use when constructing the positional initial electron
embeddings.</p></li>
<li><p><strong>use_spin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – only relevant if <code class="docutils literal notranslate"><span class="pre">positional_embeddings</span></code> is not <code class="docutils literal notranslate"><span class="pre">False</span></code>,
if <code class="docutils literal notranslate"><span class="pre">True</span></code>, concatenate the spin of the given electron after the
positional embedding features.</p></li>
<li><p><strong>project_to_embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – only relevant if <code class="docutils literal notranslate"><span class="pre">positional_embeddings</span></code>
is not <code class="docutils literal notranslate"><span class="pre">False</span></code>, if <code class="docutils literal notranslate"><span class="pre">True</span></code>, use a linear layer to project the initial
embeddings to have length <code class="docutils literal notranslate"><span class="pre">embedding_dim</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.ElectronGNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.electron_gnn.</span></span><span class="sig-name descname"><span class="pre">ElectronGNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_particle_stream_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuclei_embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electron_embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ghost_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#ElectronGNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.ElectronGNN" title="Link to this definition">#</a></dt>
<dd><p>A neural network acting on graphs defined by electrons and nuclei.</p>
<p>Derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">GraphNeuralNetwork</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<a class="reference internal" href="#deepqmc.hamil.MolecularHamiltonian" title="deepqmc.hamil.MolecularHamiltonian"><code class="xref py py-class docutils literal notranslate"><span class="pre">MolecularHamiltonian</span></code></a>) – the Hamiltonian of
the system on which the graph is defined.</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the length of the electron embedding vectors.</p></li>
<li><p><strong>n_interactions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of message passing interactions.</p></li>
<li><p><strong>edge_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – <p>a <code class="xref py py-data docutils literal notranslate"><span class="pre">dict</span></code> of functions for each edge
type, embedding the interparticle differences. Valid keys are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'ne'</span></code>: for nucleus-electron edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'nn'</span></code>: for nucleus-nucleus edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'same'</span></code>: for same spin electron-electron edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'anti'</span></code>: for opposite spin electron-electron edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'up'</span></code>: for edges going from spin up electrons to all electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'down'</span></code>: for edges going from spin down electrons to all electrons</p></li>
</ul>
</p></li>
<li><p><strong>self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to consider edges where the sender and
receiver electrons are the same.</p></li>
<li><p><strong>two_particle_stream_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the feature dimension of the two particle
streams. Only active if <code class="xref py py-data docutils literal notranslate"><span class="pre">deep_features</span></code> are used.</p></li>
<li><p><strong>nuclei_embedding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><a class="reference internal" href="#deepqmc.gnn.electron_gnn.NucleiEmbedding" title="deepqmc.gnn.electron_gnn.NucleiEmbedding"><em>NucleiEmbedding</em></a><em>]</em>) – optional, the instance responsible for creating the initial nuclear
embeddings. Set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> if nuclear embeddings are not needed.</p></li>
<li><p><strong>electron_embedding</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><a class="reference internal" href="#deepqmc.gnn.electron_gnn.ElectronEmbedding" title="deepqmc.gnn.electron_gnn.ElectronEmbedding"><em>ElectronEmbedding</em></a><em>]</em>) – the instance that creates the initial electron embeddings.</p></li>
<li><p><strong>layer_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><a class="reference internal" href="#deepqmc.gnn.electron_gnn.ElectronGNNLayer" title="deepqmc.gnn.electron_gnn.ElectronGNNLayer"><em>ElectronGNNLayer</em></a><em>]</em>) – a
callable that generates a layer of the GNN.</p></li>
<li><p><strong>ghost_coords</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – optional, specifies the coordinates of one or more
ghost atoms, useful for breaking spatial symmetries of the nuclear geometry.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.ElectronGNN.edge_factory">
<span class="sig-name descname"><span class="pre">edge_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys_conf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#ElectronGNN.edge_factory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.ElectronGNN.edge_factory" title="Link to this definition">#</a></dt>
<dd><p>Compute all the graph edges used in the GNN.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.ElectronGNNLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.electron_gnn.</span></span><span class="sig-name descname"><span class="pre">ElectronGNNLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ilayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_particle_stream_dim</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electron_residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nucleus_residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_particle_residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_factory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_factory_by_lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#ElectronGNNLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.ElectronGNNLayer" title="Link to this definition">#</a></dt>
<dd><p>The message passing layer of <a class="reference internal" href="#deepqmc.gnn.electron_gnn.ElectronGNN" title="deepqmc.gnn.electron_gnn.ElectronGNN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronGNN</span></code></a>.</p>
<p>Derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassingLayer</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_interactions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of message passing interactions.</p></li>
<li><p><strong>ilayer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the index of this layer (0 &lt;= ilayer &lt; n_interactions).</p></li>
<li><p><strong>n_nuc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of nuclei.</p></li>
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of spin up electrons.</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of spin down electrons.</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the length of the electron embedding vectors.</p></li>
<li><p><strong>edge_types</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – the types of edges to consider.</p></li>
<li><p><strong>self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to consider edges where the sender and
receiver electrons are the same.</p></li>
<li><p><strong>node_data</strong> (<em>Dict</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><em>Any</em><em>]</em>) – a dictionary containing information about the
nodes of the graph.</p></li>
<li><p><strong>two_particle_stream_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the feature dimension of the two particle
streams.</p></li>
<li><p><strong>electron_residual</strong> – whether a residual connection is used when updating
the electron embeddings, either <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, or an instance of
<a class="reference internal" href="#deepqmc.hkext.ResidualConnection" title="deepqmc.hkext.ResidualConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidualConnection</span></code></a>.</p></li>
<li><p><strong>nucleus_residual</strong> – whether a residual connection is used when updating
the nucleus embeddings, either <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, or an instance of
<a class="reference internal" href="#deepqmc.hkext.ResidualConnection" title="deepqmc.hkext.ResidualConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidualConnection</span></code></a>.</p></li>
<li><p><strong>two_particle_residual</strong> – whether a residual connection is used when updating
the two particle embeddings, either <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, or an instance of
<a class="reference internal" href="#deepqmc.hkext.ResidualConnection" title="deepqmc.hkext.ResidualConnection"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResidualConnection</span></code></a>.</p></li>
<li><p><strong>deep_features</strong> – if <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, the edge features are not updated throughout
the GNN layers, if <code class="xref py py-data docutils literal notranslate"><span class="pre">shared</span></code> than in each layer a single MLP
(<code class="xref py py-data docutils literal notranslate"><span class="pre">u</span></code>) is used to update all edge types, if <code class="xref py py-data docutils literal notranslate"><span class="pre">separate</span></code> then in
each layer separate MLPs are used to update the different edge types.</p></li>
<li><p><strong>update_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="#deepqmc.gnn.update_features.UpdateFeature" title="deepqmc.gnn.update_features.UpdateFeature"><em>UpdateFeature</em></a><em>]</em>) – a list of
partially initialized update feature classes to use when computing the
update features of the one particle embeddings. For more details see the
documentation of <a class="reference internal" href="#module-deepqmc.gnn.update_features" title="deepqmc.gnn.update_features"><code class="xref py py-class docutils literal notranslate"><span class="pre">deepqmc.gnn.update_features</span></code></a>.</p></li>
<li><p><strong>update_rule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – <p>how to combine the update features for the update of the
one particle embeddings.
Possible values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'concatenate'</span></code>: run concatenated features through MLP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'featurewise'</span></code>: apply different MLP to each feature channel and sum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'featurewise_shared'</span></code>: apply the same MLP across feature channels</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sum'</span></code>: sum features before sending through an MLP</p></li>
</ul>
<p>note that <code class="xref py py-data docutils literal notranslate"><span class="pre">'sum'</span></code> and <code class="xref py py-data docutils literal notranslate"><span class="pre">'featurewise_shared'</span></code> imply features
of same size.</p>
</p></li>
<li><p><strong>subnet_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – optional, a function that constructs
the subnetworks of the GNN layer.</p></li>
<li><p><strong>subnet_factory_by_lbl</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – optional, a dictionary of functions that construct
subnetworks of the GNN layer. If both this and <code class="xref py py-data docutils literal notranslate"><span class="pre">subnet_factory</span></code> is
specified, the specified values of <code class="xref py py-data docutils literal notranslate"><span class="pre">subnet_factory_by_lbl</span></code> will take
precedence. If some keys are missing, the default value of
<code class="xref py py-data docutils literal notranslate"><span class="pre">subnet_factory</span></code> will be used in their place. Possible keys are:
(<code class="xref py py-data docutils literal notranslate"><span class="pre">w</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">h</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">g</span></code> or <code class="xref py py-data docutils literal notranslate"><span class="pre">u</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.NucleiEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.electron_gnn.</span></span><span class="sig-name descname"><span class="pre">NucleiEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_atom_types</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_type_embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#NucleiEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.NucleiEmbedding" title="Link to this definition">#</a></dt>
<dd><p>Create initial embeddings for nuclei.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of spin up electrons.</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of spin down electrons.</p></li>
<li><p><strong>charges</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the nuclear charges of the molecule.</p></li>
<li><p><strong>n_atom_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of different atom types in the molecule.</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the length of the output embedding vector</p></li>
<li><p><strong>atom_type_embedding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – if <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a>, initial embeddings are the same
for atoms of the same type (nuclear charge), otherwise they are different
for all nuclei.</p></li>
<li><p><strong>subnet_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – the type of subnetwork to use for the embedding generation:
- <code class="docutils literal notranslate"><span class="pre">'mlp'</span></code>: an MLP is used
- <code class="docutils literal notranslate"><span class="pre">'embed'</span></code>: a <a class="reference external" href="https://dm-haiku.readthedocs.io/en/latest/api.html#haiku.Embed" title="(in Haiku)"><code class="xref py py-class docutils literal notranslate"><span class="pre">haiku.Embed</span></code></a> block is used</p></li>
<li><p><strong>edge_features</strong> (<a class="reference internal" href="#deepqmc.gnn.edge_features.EdgeFeature" title="deepqmc.gnn.edge_features.EdgeFeature"><em>EdgeFeature</em></a>) – optional, the edge
features to use when constructing the initial nuclear embeddings.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<section id="update-features">
<h4>Update Features<a class="headerlink" href="#update-features" title="Link to this heading">#</a></h4>
<p>This submodule implements some common ways to compute update features for the node embeddings from the current node and edge embeddings.
Instances of the below classes are callable, they take as input the current node and edge representations, and output a list of update features
to be used for updating the node representations.</p>
<dl class="py class" id="module-deepqmc.gnn.update_features">
<dt class="sig sig-object py" id="deepqmc.gnn.update_features.ConvolutionElectronUpdateFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.update_features.</span></span><span class="sig-name descname"><span class="pre">ConvolutionElectronUpdateFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w_for_ne</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/update_features.html#ConvolutionElectronUpdateFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.update_features.ConvolutionElectronUpdateFeature" title="Link to this definition">#</a></dt>
<dd><p>The convolution of node and edge embeddings as an update feature.</p>
<p>Returns the convolution of the node and edge embeddings for various edge types
as separate update features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin up electrons</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin down electrons</p></li>
<li><p><strong>two_particle_stream_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – dimension of the two-particle stream</p></li>
<li><p><strong>node_edge_mapping</strong> (<a class="reference internal" href="#deepqmc.gnn.utils.NodeEdgeMapping" title="deepqmc.gnn.utils.NodeEdgeMapping"><em>NodeEdgeMapping</em></a>) – mapping between the
various node and edge types.</p></li>
<li><p><strong>edge_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – list of edge types to sum over</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to normalize the sum by the number of senders</p></li>
<li><p><strong>w_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – factory function for the <span class="math">\(w\)</span> matrix</p></li>
<li><p><strong>h_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable" title="(in Python v3.13)"><em>Callable</em></a>) – factory function for the <span class="math">\(h\)</span> matrix</p></li>
<li><p><strong>w_for_ne</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to use the <span class="math">\(w\)</span> matrix for the <span class="math">\(ne\)</span> edge
type</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.update_features.EdgeSumElectronUpdateFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.update_features.</span></span><span class="sig-name descname"><span class="pre">EdgeSumElectronUpdateFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/update_features.html#EdgeSumElectronUpdateFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.update_features.EdgeSumElectronUpdateFeature" title="Link to this definition">#</a></dt>
<dd><p>The (normalized) sum of the edge embeddings as an update feature.</p>
<p>Returns the (normalized) sum of the edge embeddings for various edge types
as separate update features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin up electrons</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin down electrons</p></li>
<li><p><strong>two_particle_stream_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – dimension of the two-particle stream</p></li>
<li><p><strong>node_edge_mapping</strong> (<a class="reference internal" href="#deepqmc.gnn.utils.NodeEdgeMapping" title="deepqmc.gnn.utils.NodeEdgeMapping"><em>NodeEdgeMapping</em></a>) – mapping between the
various node and edge types.</p></li>
<li><p><strong>edge_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – list of edge types to sum over</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to normalize the sum by the number of senders</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.update_features.NodeAttentionElectronUpdateFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.update_features.</span></span><span class="sig-name descname"><span class="pre">NodeAttentionElectronUpdateFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_heads</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attention_residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mlp_residual</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/update_features.html#NodeAttentionElectronUpdateFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.update_features.NodeAttentionElectronUpdateFeature" title="Link to this definition">#</a></dt>
<dd><p>Create a single update feature by attenting over the nodes.</p>
<p>Returns the Psiformer update feature based on attention over the nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin up electrons</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin down electrons</p></li>
<li><p><strong>two_particle_stream_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – dimension of the two-particle stream</p></li>
<li><p><strong>node_edge_mapping</strong> (<a class="reference internal" href="#deepqmc.gnn.utils.NodeEdgeMapping" title="deepqmc.gnn.utils.NodeEdgeMapping"><em>NodeEdgeMapping</em></a>) – mapping between the
various node and edge types.</p></li>
<li><p><strong>num_heads</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of attention heads</p></li>
<li><p><strong>mlp_factory</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><a class="reference internal" href="#deepqmc.hkext.MLP" title="deepqmc.hkext.MLP"><em>MLP</em></a><em>]</em>) – factory function for the MLP</p></li>
<li><p><strong>attention_residual</strong> (<em>Optional</em><em>[</em><em>Residual</em><em>]</em>) – optional residual
connection after the attention layer</p></li>
<li><p><strong>mlp_residual</strong> (<em>Optional</em><em>[</em><em>Residual</em><em>]</em>) – optional residual
connection after the MLP layer</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.update_features.NodeSumElectronUpdateFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.update_features.</span></span><span class="sig-name descname"><span class="pre">NodeSumElectronUpdateFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/update_features.html#NodeSumElectronUpdateFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.update_features.NodeSumElectronUpdateFeature" title="Link to this definition">#</a></dt>
<dd><p>The (normalized) sum of the node embeddings as an update feature.</p>
<p>Returns the (normalized) sum of the electron embeddings from the previous layer as
a single update feature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin up electrons</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin down electrons</p></li>
<li><p><strong>two_particle_stream_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – dimension of the two-particle stream</p></li>
<li><p><strong>node_edge_mapping</strong> (<a class="reference internal" href="#deepqmc.gnn.utils.NodeEdgeMapping" title="deepqmc.gnn.utils.NodeEdgeMapping"><em>NodeEdgeMapping</em></a>) – mapping between the
various node and edge types.</p></li>
<li><p><strong>node_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – list of node types to update</p></li>
<li><p><strong>normalize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>) – whether to normalize the sum by the number of nodes</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.update_features.ResidualElectronUpdateFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.update_features.</span></span><span class="sig-name descname"><span class="pre">ResidualElectronUpdateFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_particle_stream_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_edge_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/update_features.html#ResidualElectronUpdateFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.update_features.ResidualElectronUpdateFeature" title="Link to this definition">#</a></dt>
<dd><p>Residual update feature.</p>
<p>Returns the unchanged electron embeddings from the previous layer as
a single update feature.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.update_features.UpdateFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.update_features.</span></span><span class="sig-name descname"><span class="pre">UpdateFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_particle_stream_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_edge_mapping</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/update_features.html#UpdateFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.update_features.UpdateFeature" title="Link to this definition">#</a></dt>
<dd><p>Base class for all update features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin up electrons</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – number of spin down electrons</p></li>
<li><p><strong>two_particle_stream_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – dimension of the two-particle stream</p></li>
<li><p><strong>node_edge_mapping</strong> (<a class="reference internal" href="#deepqmc.gnn.utils.NodeEdgeMapping" title="deepqmc.gnn.utils.NodeEdgeMapping"><em>NodeEdgeMapping</em></a>) – mapping between the
various node and edge types.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.utils.NodeEdgeMapping">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.utils.</span></span><span class="sig-name descname"><span class="pre">NodeEdgeMapping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/utils.html#NodeEdgeMapping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.utils.NodeEdgeMapping" title="Link to this definition">#</a></dt>
<dd><p>A utility mapping between the various node and edge types.</p>
<p>For example it is often useful determine the sender/receiver node type of a given
edge, or generate all the edge types with a given sender/receiver node.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edges</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>]</em>) – all the edge types present in the graph</p></li>
<li><p><strong>node_data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – optional, data to store for the node types</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
</section>
<section id="excited-electronic-states">
<h2>Excited electronic states<a class="headerlink" href="#excited-electronic-states" title="Link to this heading">#</a></h2>
<p>This section documents the API used to treat electronic excited states.</p>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.combined_samplers.MultiElectronicStateSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.combined_samplers.</span></span><span class="sig-name descname"><span class="pre">MultiElectronicStateSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling/combined_samplers.html#MultiElectronicStateSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.combined_samplers.MultiElectronicStateSampler" title="Link to this definition">#</a></dt>
<dd><p>Sample from multiple electronic states in parallel.</p>
<p>This sampler applies <code class="docutils literal notranslate"><span class="pre">vmap</span></code> to an underlying
<a class="reference internal" href="#deepqmc.sampling.base.ElectronSampler" title="deepqmc.sampling.base.ElectronSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronSampler</span></code></a> to sample from multiple electronic
states in parallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sampler</strong> (<a class="reference internal" href="#deepqmc.sampling.base.ElectronSampler" title="deepqmc.sampling.base.ElectronSampler"><em>ElectronSampler</em></a>) – the electron sampler to use.</p></li>
<li><p><strong>n_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>) – the number of electronic states to sample from.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class" id="module-deepqmc.loss.overlap">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.OverlapGradientScaleFactory">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">OverlapGradientScaleFactory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#OverlapGradientScaleFactory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.OverlapGradientScaleFactory" title="Link to this definition">#</a></dt>
<dd><p>Callable that computes the scaling factor of the overlap gradient.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.compute_mean_overlap">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">compute_mean_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#compute_mean_overlap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.compute_mean_overlap" title="Link to this definition">#</a></dt>
<dd><p>Compute an estimate of the overlap matrix from WF ratios.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi_ratio</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the WF ratios
<span class="math">\(\text{ratio}[i,\,j,\,:]=\frac{\Psi_i(r\sim\Psi^2_j)}{\Psi_j(r\sim\Psi^2_j)}\)</span>,
shape: <code class="xref py py-data docutils literal notranslate"><span class="pre">[n_wfs,</span> <span class="pre">n_wfs,</span> <span class="pre">elec_batch_size]</span></code>.</p></li>
<li><p><strong>weight</strong> (<em>Weight</em>) – the sample weights, shape
<code class="xref py py-data docutils literal notranslate"><span class="pre">[n_wfs,</span> <span class="pre">elec_batch_size]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>tuple of the symmetric overlap matrix estimate, shaped
<code class="docutils literal notranslate"><span class="pre">[mol_batch_size,</span> <span class="pre">n_wfs,</span> <span class="pre">n_wfs]</span></code>, and overlap statistics.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>, Stats]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.compute_mean_overlap_tangent">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">compute_mean_overlap_tangent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi_ratio</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_psi_tangent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ratio_gradient_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#compute_mean_overlap_tangent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.compute_mean_overlap_tangent" title="Link to this definition">#</a></dt>
<dd><p>Compute the tangent of the overlap matrix with respect to the Ansatz parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi_ratio</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the ratio of WF values.</p></li>
<li><p><strong>weight</strong> (<em>Weight</em>) – the weight of each sample.</p></li>
<li><p><strong>log_psi_tangent</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the jvp of the WF values with respect to the
parameters of the Ansatz.</p></li>
<li><p><strong>ratio_gradient_mask</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – a samplewise boolean mask to apply to the
gradients.</p></li>
<li><p><strong>overlap</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the overlap matrix estimate.</p></li>
<li><p><strong>scale_factory</strong> (<a class="reference internal" href="#deepqmc.loss.overlap.OverlapGradientScaleFactory" title="deepqmc.loss.overlap.OverlapGradientScaleFactory"><em>OverlapGradientScaleFactory</em></a>) – function that computes the scaling
factor of the overlap gradient.</p></li>
<li><p><strong>data</strong> (<em>DataDict</em>) – input data passed to the <code class="docutils literal notranslate"><span class="pre">scale_factory</span></code> function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the jvp of the sum of the upper triangle of the overlap matrix with</dt><dd><p>respect to the Ansatz parameters.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.compute_psi_ratio">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">compute_psi_ratio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ansatz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys_conf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#compute_psi_ratio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.compute_psi_ratio" title="Link to this definition">#</a></dt>
<dd><p>Compute the ratio of all wave function for a batch of samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ansatz</strong> (<a class="reference internal" href="#deepqmc.types.Ansatz" title="deepqmc.types.Ansatz"><em>Ansatz</em></a>) – the ansatz object.</p></li>
<li><p><strong>params</strong> (<em>Params</em>) – the current parameters of the Ansatz.</p></li>
<li><p><strong>phys_conf</strong> (<a class="reference internal" href="#deepqmc.types.PhysicalConfiguration" title="deepqmc.types.PhysicalConfiguration"><em>PhysicalConfiguration</em></a>) – the input to the Ansatz,
shape: <code class="docutils literal notranslate"><span class="pre">[mol_batch_size,</span> <span class="pre">electronic_states,</span> <span class="pre">electron_batch_size,</span> <span class="pre">...]</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the tuple of the WF ratios and overlap</dt><dd><p>statistics.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)">tuple</a>[<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a>, <em>Stats</em>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.compute_single_sample_psi_ratios">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">compute_single_sample_psi_ratios</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">psi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_log_psi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#compute_single_sample_psi_ratios"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.compute_single_sample_psi_ratios" title="Link to this definition">#</a></dt>
<dd><p>Compute all possible ratios between the WFs for a single sample.</p>
<p>The mean of each WF value is subtracted before computing exponentials to avoid
over/underflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>psi</strong> (<a class="reference internal" href="#deepqmc.types.Psi" title="deepqmc.types.Psi"><em>Psi</em></a>) – all WF values for a single molecule
and electron sample, shape: <code class="xref py py-data docutils literal notranslate"><span class="pre">[electronic_states,</span> <span class="pre">electronic_states]</span></code>.
mean_log_psi (jax.Array): mean log magnitude of the WFs, [electronic_states]</p></li>
<li><p><strong>mean_log_psi</strong> (<a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><em>jax.Array</em></a>) – the mean log psi values for each state,
shape [electronic_states]</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the WF ratios</dt><dd><p><span class="math">\(R[i,\,j]=\frac{\Psi_i(r\sim\Psi^2_j)}{\Psi_j(r\sim\Psi^2_j)}\)</span>,
shape <code class="xref py py-data docutils literal notranslate"><span class="pre">[electronic_states,</span> <span class="pre">electronic_states]</span></code>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)">jax.Array</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.compute_wave_function_values">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">compute_wave_function_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ansatz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phys_conf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#compute_wave_function_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.compute_wave_function_values" title="Link to this definition">#</a></dt>
<dd><p>Compute the value of all WFs at samples drawn from all WFs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>) – PyTree of WF parameters, with leading axis over the
different WFs. Shape: <code class="xref py py-data docutils literal notranslate"><span class="pre">[n_wfs,</span> <span class="pre">...]</span></code>.</p></li>
<li><p><strong>phys_conf</strong> (<a class="reference internal" href="#deepqmc.types.PhysicalConfiguration" title="deepqmc.types.PhysicalConfiguration"><em>PhysicalConfiguration</em></a>) – input physical
configuration samples, with leading axis over the different WFs
the samples were drawn from.
Shape: <code class="xref py py-data docutils literal notranslate"><span class="pre">[n_wfs,</span> <span class="pre">elec_batch_size,</span> <span class="pre">...]</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>the WF values</dt><dd><p><span class="math">\(\Psi[i, \, j, \, :] = \Psi_i({\bf r} \sim \Psi^2_j)\)</span>,
shape: <code class="xref py py-data docutils literal notranslate"><span class="pre">[n_wfs,</span> <span class="pre">n_wfs,</span> <span class="pre">elec_batch_size]</span></code>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#deepqmc.types.Psi" title="deepqmc.types.Psi"><em>Psi</em></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.no_scaling">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">no_scaling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#no_scaling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.no_scaling" title="Link to this definition">#</a></dt>
<dd><p>Return unit scaling factor.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.scale_by_energy_gap">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">scale_by_energy_gap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap_scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#scale_by_energy_gap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.scale_by_energy_gap" title="Link to this definition">#</a></dt>
<dd><p>Scale the overlap gradient by the energy gap between the two states.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.scale_by_energy_std">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">scale_by_energy_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap_scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#scale_by_energy_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.scale_by_energy_std" title="Link to this definition">#</a></dt>
<dd><p>Scale the overlap gradient by the std. dev. of the states’ energies.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.scale_by_max_gap_std">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">scale_by_max_gap_std</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_gap_scale_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#scale_by_max_gap_std"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.scale_by_max_gap_std" title="Link to this definition">#</a></dt>
<dd><p>Scale the overlap gradient by the max of the energy gap and std. dev.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.loss.overlap.symmetrize_overlap_with_clipped_geometric_mean">
<span class="sig-prename descclassname"><span class="pre">deepqmc.loss.overlap.</span></span><span class="sig-name descname"><span class="pre">symmetrize_overlap_with_clipped_geometric_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/loss/overlap.html#symmetrize_overlap_with_clipped_geometric_mean"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.loss.overlap.symmetrize_overlap_with_clipped_geometric_mean" title="Link to this definition">#</a></dt>
<dd><p>Symmetrize the overlap using the clipped geometric mean of it and its transpose.</p>
<p>Useful for computing an estimate of the overlap matrix using Monte Carlo samples
from all WFs. Given input <span class="math">\(x_{ij}\)</span> this function computes:</p>
<div class="math">
\[y_{ij}=\text{sign}(x_{ij}) \sqrt{\text{clamp}(0, \, x_{ij} \cdot x_{ji}, \, 1)}

\]</div>
<p>Note that if the signs of <span class="math">\(x_{ij}\)</span> and <span class="math">\(x_{ji}\)</span> differ, the clamping
makes sure that <span class="math">\(y_{ij}\)</span> will be zero. Otherwise the two signs will agree,
and we can use either one of them to compute the sign of <span class="math">\(y_{ij}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – the non-symmetric overlap values:
<span class="math">\(x_{ij}=\frac1N\sum_{{\bf r}_j\sim\Psi^2_j}\frac{\Psi_i({\bf r}_j)}
{\Psi_j({\bf r}_j)}\)</span></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="custom-data-types-and-type-aliases">
<h2>Custom data types and type aliases<a class="headerlink" href="#custom-data-types-and-type-aliases" title="Link to this heading">#</a></h2>
<p>In order to facilitate the use of the API and enable type checking DeepQMC implements a range of custom types and type aliases.</p>
<p>A combination of electron and nuclei positions is assigned the PhysicalConfiguration type.</p>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.types.PhysicalConfiguration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">PhysicalConfiguration</span></span><a class="headerlink" href="#deepqmc.types.PhysicalConfiguration" title="Link to this definition">#</a></dt>
<dd><p>Represent physical configurations of electrons and nuclei.</p>
<p>It currently contains the nuclear and electronic coordinates, along with
<code class="xref py py-data docutils literal notranslate"><span class="pre">mol_idx</span></code>, which specifies which nuclear configuration a given sample
was obtained from.</p>
</dd></dl>

<p>Wave function parameters are denoted with the Params type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.Params">
<span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">Params</span></span><a class="headerlink" href="#deepqmc.types.Params" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.MutableMapping" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">MutableMapping</span></code></a></p>
</dd></dl>

<p>Auxiliary data need for the evaluation of the loss comes as a DataDict type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.DataDict">
<span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">DataDict</span></span><a class="headerlink" href="#deepqmc.types.DataDict" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd></dl>

<p>Statistics obtained during training or evaluation use the Stats type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.Stats">
<span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">Stats</span></span><a class="headerlink" href="#deepqmc.types.Stats" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd></dl>

<p>Data for the evaluation of the training loss is bundeld as a Batch type.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="deepqmc.types.Batch">
<span class="sig-prename descclassname"><span class="pre">deepqmc.types.</span></span><span class="sig-name descname"><span class="pre">Batch</span></span><a class="headerlink" href="#deepqmc.types.Batch" title="Link to this definition">#</a></dt>
<dd><p>alias of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></a>[<code class="xref py py-class docutils literal notranslate"><span class="pre">pytree_dataclass</span></code>, <a class="reference external" href="https://jax.readthedocs.io/en/latest/_autosummary/jax.Array.html#jax.Array" title="(in JAX)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Array</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a> | <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.13)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>]</p>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="refs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2019-2024, Frank Noé and collaborators.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.15.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>