

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>API &#8212; DeepQMC 1.1.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=ac02cc09edc035673794" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=ac02cc09edc035673794" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=ac02cc09edc035673794" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/katex-math.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=ac02cc09edc035673794"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/katex.min.js"></script>
    <script src="_static/auto-render.min.js"></script>
    <script src="_static/katex_autorenderer.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="refs.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="index.html">
  
  
  
  
  
    <p class="title logo__title">DeepQMC 1.1.0 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="cli.html">
                        Command-line interface
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="tutorial.html">
                        Tutorial
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="refs.html">
                        References
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/deepqmc/deepqmc" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="cli.html">
                        Command-line interface
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="tutorial.html">
                        Tutorial
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="refs.html">
                        References
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/deepqmc/deepqmc" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i></span>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#haiku">Haiku</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-deepqmc.train">Training and evaluation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sampling">Sampling</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#wave-functions">Wave functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#graph-neural-networks">Graph neural networks</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graphs">Graphs</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#electrongnn">ElectronGNN</a></li>
</ul>
</li>
</ul>
  </nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page">API</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="id1">
<h1>API<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<p>This is the documentation of the API of the JAX implementation of the <a class="reference internal" href="#module-deepqmc" title="deepqmc"><code class="xref py py-class docutils literal notranslate"><span class="pre">deepqmc</span></code></a> package.</p>
<p>This implementation uses the <a class="reference external" href="https://github.com/google/jax">JAX library</a>, the documentation for which can be found here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jax.readthedocs.io/en/latest">JAX documentation</a></p></li>
</ul>
<span class="target" id="module-deepqmc"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bohr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.Molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Represents a molecule.</p>
<p>The array-like arguments accept anything that can be transformed to
<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.numpy.DeviceArray</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (float, (<span class="math">\(N_\text{nuc}\)</span>, 3), a.u.) – nuclear coordinates as rows</p></li>
<li><p><strong>charges</strong> (int, (<span class="math">\(N_\text{nuc}\)</span>)) – atom charges</p></li>
<li><p><strong>charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – total charge of a molecule</p></li>
<li><p><strong>spin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – total spin multiplicity</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.Molecule.from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/molecule.html#Molecule.from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.Molecule.from_name" title="Permalink to this definition">#</a></dt>
<dd><p>Create a molecule from a database of named molecules.</p>
<p>The available names are in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.all_names</span></code>.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-deepqmc.hamil"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hamil.Hamiltonian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hamil.</span></span><span class="sig-name descname"><span class="pre">Hamiltonian</span></span><a class="reference internal" href="_modules/deepqmc/hamil/base.html#Hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.Hamiltonian" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all Hamiltonian operators.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.hamil.Hamiltonian.local_energy">
<span class="sig-name descname"><span class="pre">local_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil/base.html#Hamiltonian.local_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.Hamiltonian.local_energy" title="Permalink to this definition">#</a></dt>
<dd><p>Return a function that calculates the local energy of the wave function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wf</strong> (<em>WaveFunction</em>) – the wave function ansatz.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a function that evaluates
the local energy of <code class="xref py py-data docutils literal notranslate"><span class="pre">wf</span></code> at <code class="xref py py-data docutils literal notranslate"><span class="pre">r</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable[r,</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hamil.MolecularHamiltonian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hamil.</span></span><span class="sig-name descname"><span class="pre">MolecularHamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pp_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil/qc.html#MolecularHamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.MolecularHamiltonian" title="Permalink to this definition">#</a></dt>
<dd><p>Hamiltonian of non-relativistic molecular systems.</p>
<p>The system consists of nuclei with fixed positions and electrons moving
around them. The total energy is defined as the sum of the nuclear-nuclear
and electron-electron repulsion, the nuclear-electron attraction, and the
kinetic energy of the electrons:
<span class="math">\(E=V_\text{nuc-nuc} + V_\text{el-el} + V_\text{nuc-el} + E_\text{kin}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<a class="reference internal" href="#deepqmc.Molecule" title="deepqmc.Molecule"><em>Molecule</em></a>) – the molecule to consider</p></li>
<li><p><strong>pp_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – If set, use the appropriate pseudopotential. The string is passed
to <code class="xref py py-func docutils literal notranslate"><span class="pre">pyscf.gto.M()</span></code> as <code class="xref py py-data docutils literal notranslate"><span class="pre">'ecp'</span></code> argument. Supports
pseudopotentials that are implemented in the pyscf package, e.g.
<code class="xref py py-data docutils literal notranslate"><span class="pre">'bfd'</span></code> [Burkatzki et al. 2007] or <code class="xref py py-data docutils literal notranslate"><span class="pre">'ccECP'</span></code>
[Bennett et al. 2017].</p></li>
<li><p><strong>pp_mask</strong> (list, (<span class="math">\(N_\text{nuc}\)</span>)) – list of True and False values specifying
whether to use a pseudopotential for each nucleus</p></li>
<li><p><strong>elec_std</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – optional, a default value of the scaling factor</p></li>
<li><p><strong>nuclei.</strong> (<em>of the spread</em><em> of </em><em>electrons around the</em>) – </p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.hamil.MolecularHamiltonian.init_sample">
<span class="sig-name descname"><span class="pre">init_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil/qc.html#MolecularHamiltonian.init_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.MolecularHamiltonian.init_sample" title="Permalink to this definition">#</a></dt>
<dd><p>Guess some initial electron positions.</p>
<p>Tries to make an educated guess about plausible initial electron
configurations. Places electrons according to normal distributions
centered on the nuclei. If the molecule is not neutral, extra electrons
are placed on or removed from random nuclei. The resulting configurations
are usually very crude, a subsequent, thorough equilibration is needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>jax.random.PRNGKey</em>) – key used for PRNG.</p></li>
<li><p><strong>R</strong> (float, (<span class="math">\(N_\text{nuc}\)</span>, 3)) – nuclear coordinates of a single
molecular geometry</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the number of configurations to generate.
electrons around the nuclei.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="haiku">
<h2>Haiku<a class="headerlink" href="#haiku" title="Permalink to this heading">#</a></h2>
<p>The JAX implementation uses the <a class="reference external" href="https://github.com/deepmind/dm-haiku">haiku library</a> to create, train and evaluate neural network models.
Some additional neural network functionality is implemented in the package and documented here.</p>
<span class="target" id="module-deepqmc.hkext"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.Identity">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">Identity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#Identity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.Identity" title="Permalink to this definition">#</a></dt>
<dd><p>Represent the identity operation.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.MLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.MLP" title="Permalink to this definition">#</a></dt>
<dd><p>Represent a multilayer perceptron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the input dimension.</p></li>
<li><p><strong>out_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the output dimension.</p></li>
<li><p><strong>residual</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – whether to include a residual connection</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – optional, the name of the network.</p></li>
<li><p><strong>hidden_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a>) – optional, either (‘log’, <span class="math">\(N_\text{layers}\)</span>),
in which case the network will have <span class="math">\(N_\text{layers}\)</span> layers
with logarithmically changing widths, or a tuple of ints specifying
the width of each layer.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – <p>optional, specifies which layers should have a bias term.
Possible values are</p>
<ul>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a>: all layers will have a bias term</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>: no layers will have a bias term</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'not_last'</span></code>: all but the last layer will have a bias term</p></li>
</ul>
</p></li>
<li><p><strong>last_linear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – optional, if <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a> the activation function
is not applied to the activation of the last layer.</p></li>
<li><p><strong>activation</strong> (<em>Callable</em>) – optional, the activation function.</p></li>
<li><p><strong>w_init</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em> or </em><em>Callable</em>) – <p>optional, specifies the initialization of the
linear weights. Possible string values are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code>: the default haiku initialization method is used.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'deeperwin'</span></code>: the initialization method of the <code class="xref py py-class docutils literal notranslate"><span class="pre">deeperwin</span></code></dt><dd><p>package is used.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.ResidualConnection">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">ResidualConnection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#ResidualConnection"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.ResidualConnection" title="Permalink to this definition">#</a></dt>
<dd><p>Represent a residual connection between pytrees.</p>
<p>The residual connection is only added if <code class="xref py py-data docutils literal notranslate"><span class="pre">inp</span></code> and <code class="xref py py-data docutils literal notranslate"><span class="pre">update</span></code>
have the same shape.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>normalize</strong> (<em>-</em>) – if <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a> the sum of <code class="xref py py-data docutils literal notranslate"><span class="pre">inp</span></code> and <code class="xref py py-data docutils literal notranslate"><span class="pre">update</span></code>
is normalized with <code class="xref py py-data docutils literal notranslate"><span class="pre">sqrt(2)</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.SumPool">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">SumPool</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#SumPool"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.SumPool" title="Permalink to this definition">#</a></dt>
<dd><p>Represent a global sum pooling operation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.hkext.ssp">
<span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">ssp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#ssp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.ssp" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the shifted softplus activation function.</p>
<p>Computes the elementwise function
<span class="math">\(\text{softplus}(x)=\log(1+\text{e}^x)+\log\frac{1}{2}\)</span></p>
</dd></dl>

</section>
<section id="module-deepqmc.train">
<span id="training-and-evaluation"></span><h2>Training and evaluation<a class="headerlink" href="#module-deepqmc.train" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.train.train">
<span class="sig-prename descclassname"><span class="pre">deepqmc.train.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ansatz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electron_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecule_batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_restarts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_eq_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrain_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrain_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrain_sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkptdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkpts_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/train.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.train.train" title="Permalink to this definition">#</a></dt>
<dd><p>Train or evaluate a JAX wave function model.</p>
<p>It initializes and equilibrates the MCMC sampling of the wave function ansatz,
then optimizes or samples it using the variational principle. It optionally
saves checkpoints and rewinds the training/evaluation if an error is encountered.
If an optimizer is supplied, the Ansatz is optimized, otherwise the Ansatz is
only sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<a class="reference internal" href="#deepqmc.hamil.Hamiltonian" title="deepqmc.hamil.Hamiltonian"><em>Hamiltonian</em></a>) – the Hamiltonian of the physical system.</p></li>
<li><p><strong>ansatz</strong> (<a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><em>WaveFunction</em></a>) – the wave function Ansatz.</p></li>
<li><p><strong>opt</strong> (<code class="docutils literal notranslate"><span class="pre">kfac_jax</span></code> or <code class="docutils literal notranslate"><span class="pre">optax</span></code> optimizers, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>) – <p>the optimizer. Possible values are:</p>
<ul>
<li><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">kfac_jax.Optimizer</span></code>: the partially initialized KFAC optimizer</dt><dd><p>is used</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>an <code class="xref py py-data docutils literal notranslate"><span class="pre">optax</span></code> optimizer instance: the supplied <code class="xref py py-data docutils literal notranslate"><span class="pre">optax</span></code></dt><dd><p>optimizer is used.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>: the name of the optimizer to use (<code class="xref py py-data docutils literal notranslate"><span class="pre">'kfac'</span></code> or an</dt><dd><p><code class="xref py py-data docutils literal notranslate"><span class="pre">optax</span></code> optimzier name). Arguments to the optimizer can be
passed in <code class="xref py py-data docutils literal notranslate"><span class="pre">opt_kwargs</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>: no optimizer is used, e.g. the evaluation of the Ansatz</dt><dd><p>is performed.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>sampler</strong> (<a class="reference internal" href="#deepqmc.sampling.Sampler" title="deepqmc.sampling.Sampler"><em>Sampler</em></a>) – a sampler instance</p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of optimization steps.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the seed used for PRNG.</p></li>
<li><p><strong>electron_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the number of electron samples considered in a batch</p></li>
<li><p><strong>molecule_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, the number of molecules considered in a
batch. Only needed for transferable training.</p></li>
<li><p><strong>mols</strong> (<em>Sequence</em><em>(</em><a class="reference internal" href="#deepqmc.Molecule" title="deepqmc.molecule.Molecule"><em>Molecule</em></a><em>)</em>) – optional, a sequence of molecules
to consider for transferable training. If None the default molecule from
hamil is used.</p></li>
<li><p><strong>workdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – optional, path, where results should be saved.</p></li>
<li><p><strong>train_state</strong> (<em>TrainState</em>) – optional, training checkpoint to
restore training or run evaluation.</p></li>
<li><p><strong>init_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, initial step index, useful if
calculation is restarted from checkpoint saved on disk.</p></li>
<li><p><strong>max_restarts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, the maximum number of times the training is
retried before a <code class="xref py py-class docutils literal notranslate"><span class="pre">NaNError</span></code> is raised.</p></li>
<li><p><strong>max_eq_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, maximum number of equilibration steps if not
detected earlier.</p></li>
<li><p><strong>pretrain_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, the number of pretraining steps wrt. to the
Baseline wave function obtained with pyscf.</p></li>
<li><p><strong>pretrain_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – optional, extra arguments for pretraining.</p></li>
<li><p><strong>opt_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – optional, extra arguments passed to the optimizer.</p></li>
<li><p><strong>fit_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – optional, extra arguments passed to the <code class="xref py py-func docutils literal notranslate"><span class="pre">fit_wf()</span></code>
function.</p></li>
<li><p><strong>chkptdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – optional, path, where checkpoints should be saved. Checkpoints
are only saved if <code class="xref py py-data docutils literal notranslate"><span class="pre">workdir</span></code> is not <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>. Default:
data:<cite>workdir</cite>.</p></li>
<li><p><strong>chkpts_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – optional, extra arguments for checkpointing.</p></li>
<li><p><strong>metric_logger</strong> – optional, an object that consumes metric logging information.
If not specified, the default <cite>~.log.TensorboardMetricLogger</cite> is used
to create tensorboard logs.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-deepqmc.fit"></span></section>
<section id="sampling">
<h2>Sampling<a class="headerlink" href="#sampling" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.Sampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">Sampler</span></span><a class="reference internal" href="_modules/deepqmc/sampling.html#Sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.Sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all QMC samplers.</p>
</dd></dl>

<span class="target" id="module-deepqmc.sampling"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.DecorrSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">DecorrSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#DecorrSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.DecorrSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Insert decorrelating steps into chained samplers.</p>
<p>This sampler cannot be used as the last element of a sampler chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the samples will be taken in every <code class="xref py py-data docutils literal notranslate"><span class="pre">length</span></code> MCMC step,
that is, <code class="xref py py-data docutils literal notranslate"><span class="pre">length</span></code> <span class="math">\(-1\)</span> decorrelating steps are inserted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.LangevinSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">LangevinSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#LangevinSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.LangevinSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Langevin Monte Carlo sampler.</p>
<p>Derived from <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.MetropolisSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">MetropolisSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#MetropolisSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.MetropolisSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Metropolis–Hastings Monte Carlo sampler.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code> method of this class returns electron coordinate samples
from the distribution defined by the square of the sampled wave function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<em>jax.hamil.Hamiltonian</em>) – the Hamiltonian of the physical system</p></li>
<li><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – optional, the proposal step size scaling factor. Adjusted during
every step if <code class="xref py py-data docutils literal notranslate"><span class="pre">target_acceptance</span></code> is specified.</p></li>
<li><p><strong>target_acceptance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – optional, if specified the proposal step size
will be scaled such that the ratio of accepted proposal steps approaches
<code class="xref py py-data docutils literal notranslate"><span class="pre">target_acceptance</span></code>.</p></li>
<li><p><strong>max_age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, if specified the next proposed step will always be
accepted for a walker that hasn’t moved in the last <code class="xref py py-data docutils literal notranslate"><span class="pre">max_age</span></code> steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.ResampledSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">ResampledSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#ResampledSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.ResampledSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Add resampling to chained samplers.</p>
<p>This sampler cannot be used as the last element of a sampler chain.
The resampling is performed by accumulating weights on each MCMC walker
in each step. Based on a fixed resampling period <code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> and/or a
threshold <code class="xref py py-data docutils literal notranslate"><span class="pre">treshold</span></code> on the normalized effective sample size the walker
positions are sampled according to the multinomial distribution defined by
these weights, and the weights are reset to one. Either <code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> or
<code class="xref py py-data docutils literal notranslate"><span class="pre">treshold</span></code> have to be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>period</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – optional, if specified the walkers are resampled every
<code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> MCMC steps.</p></li>
<li><p><strong>treshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – optional, if specified the walkers are resampled if
the effective sample size normalized with the batch size is below
<code class="xref py py-data docutils literal notranslate"><span class="pre">treshold</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.sampling.chain">
<span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">samplers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#chain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.chain" title="Permalink to this definition">#</a></dt>
<dd><p>Combine multiple sampler types, to create advanced sampling schemes.</p>
<p>For example <code class="xref py py-data docutils literal notranslate"><span class="pre">chain(DecorrSampler(10),MetropolisSampler(hamil,</span> <span class="pre">tau=1.))</span></code>
will create a <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a>, where the samples
are taken from every 10th MCMC step. The last element of the sampler chain has
to be either a <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a> or a <a class="reference internal" href="#deepqmc.sampling.LangevinSampler" title="deepqmc.sampling.LangevinSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">LangevinSampler</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samplers</strong> (<em>Sampler</em>) – one or more sampler instances to combine.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the combined sampler.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Sampler</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="wave-functions">
<h2>Wave functions<a class="headerlink" href="#wave-functions" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.wf.WaveFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.wf.</span></span><span class="sig-name descname"><span class="pre">WaveFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/base.html#WaveFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.wf.WaveFunction" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all trial wave functions.</p>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Input, <span class="math">\(\mathbf r\)</span>, (float, <span class="math">\((N,3)\)</span>, a.u.): particle</dt><dd><p>coordinates</p>
</dd>
</dl>
</li>
<li><p>Output1, <span class="math">\(\ln|\psi(\mathbf r)|\)</span> (float):</p></li>
<li><p>Output2, <span class="math">\(\operatorname{sgn}\psi(\mathbf r)\)</span> (float):</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.wf.NeuralNetworkWaveFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.wf.</span></span><span class="sig-name descname"><span class="pre">NeuralNetworkWaveFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.12)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/nn_wave_function/nn_wave_function.html#NeuralNetworkWaveFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.wf.NeuralNetworkWaveFunction" title="Permalink to this definition">#</a></dt>
<dd><p>Implements the neural network wave function.</p>
<p>Configuration files to obtain the PauliNet <a class="reference internal" href="refs.html#hermannnc20" id="id2"><span>[HermannNC20]</span></a>, FermiNet <a class="reference internal" href="refs.html#pfauprr20" id="id3"><span>[PfauPRR20]</span></a>,
DeepErwin <a class="reference internal" href="refs.html#gerard22" id="id4"><span>[Gerard22]</span></a> and PsiFormer <a class="reference internal" href="refs.html#glehn22" id="id5"><span>[Glehn22]</span></a> architectures are provided. For a
detailed description of the implemented architecture see <a class="reference internal" href="refs.html#schaetzle23" id="id6"><span>[Schaetzle23]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<em>~MolecularHamiltonian</em>) – the Hamiltonian of the system.</p></li>
<li><p><strong>omni_factory</strong> (<em>Callable</em>) – creates the omni net.</p></li>
<li><p><strong>envelope</strong> (<em>ExponentialEnvelopes</em>) – the orbital envelopes.</p></li>
<li><p><strong>backflow_op</strong> (<em>Callable</em>) – specifies how the backflow is applied to the
orbitals.</p></li>
<li><p><strong>n_determinants</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – specifies the number of determinants</p></li>
<li><p><strong>full_determinant</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, the determinants are
factorized into spin-up and spin-down parts.</p></li>
<li><p><strong>cusp_electrons</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – whether to apply the electronic cusp correction.</p></li>
<li><p><strong>cusp_alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – the <span class="math">\(\alpha\)</span> factor of the electronic cusp
correction.</p></li>
<li><p><strong>backflow_transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – <p>describes the backflow transformation.
Possible values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mult'</span></code>: the backflow is a multiplicative factor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'add'</span></code>: the backflow is an additive term</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'both'</span></code>: the backflow consist of a multiplicative factor</dt><dd><p>and an additive term</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>conf_coeff</strong> (<em>Callable</em>) – returns a function that combines the determinants
to obtain the WF value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-deepqmc.wf.nn_wave_function.nn_wave_function"></span></section>
<section id="graph-neural-networks">
<h2>Graph neural networks<a class="headerlink" href="#graph-neural-networks" title="Permalink to this heading">#</a></h2>
<p>A graph neural network is the most important component of the neural network wave function ansatz.
This module implements a general gnn framework, that can be configured to obtain a variety of different ansatzes.</p>
<section id="graphs">
<h3>Graphs<a class="headerlink" href="#graphs" title="Permalink to this heading">#</a></h3>
<p>This submodule implements the basic functionality for working with graphs.</p>
<span class="target" id="module-deepqmc.gnn.graph"></span><dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.GraphEdgeBuilder">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">GraphEdgeBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask_self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_vals</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#GraphEdgeBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.GraphEdgeBuilder" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that builds graph edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filter_self</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – whether to filter edges between nodes of the same index.</p></li>
<li><p><strong>offsets</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>)</em>) – node index offset to be added to the returned
sender and receiver node indeces respectively.</p></li>
<li><p><strong>mask_vals</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>)</em>) – if <code class="docutils literal notranslate"><span class="pre">occupancy_limit</span></code> is larger than the number
of valid edges, the remaining node indices will be filled with these
values for the sender and receiver nodes respectively
(i.e. the value to pad the node index arrays with).</p></li>
<li><p><strong>feature_callback</strong> (<em>Callable</em>) – a function that takes the sender positions,
receiver positions, sender node indeces and receiver node indeces and
returns some data (features) computed for the edges.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.GraphUpdate">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">GraphUpdate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aggregate_edges_for_nodes_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_nodes_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_edges_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#GraphUpdate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.GraphUpdate" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that updates a graph.</p>
<p>The update function is tailored to be used in GNNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aggregate_edges_for_nodes_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – whether to perform the aggregation
of edges for nodes.</p></li>
<li><p><strong>update_nodes_fn</strong> (<em>Callable</em>) – optional, function that updates the nodes.</p></li>
<li><p><strong>update_edges_fn</strong> (<em>Callable</em>) – optional, function that updates the edges.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.MolecularGraphEdgeBuilder">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">MolecularGraphEdgeBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_types</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#MolecularGraphEdgeBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.MolecularGraphEdgeBuilder" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that builds many types of molecular edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_nuc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of nuclei.</p></li>
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of spin-up electrons.</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of spin-down electrons.</p></li>
<li><p><strong>edge_types</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em>) – <p>list of edge type names to build. Possible names are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'nn'</span></code>: nuclei-&gt;nuclei edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ne'</span></code>: nuclei-&gt;electrons edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'en'</span></code>: electrons-&gt;nuclei edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'same'</span></code>: edges betwen same-spin electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'anti'</span></code>: edges betwen opposite-spin electrons</p></li>
</ul>
</p></li>
<li><p><strong>self_interaction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – whether edges between a particle and itself are
considered</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-deepqmc.gnn.edge_features"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.CombinedEdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">CombinedEdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#CombinedEdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.CombinedEdgeFeature" title="Permalink to this definition">#</a></dt>
<dd><p>Combine multiple edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>features</strong> (<em>Sequence</em>) – a <code class="xref py py-data docutils literal notranslate"><span class="pre">Sequence</span></code> of edge feature objects
to combine.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.DifferenceEdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">DifferenceEdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#DifferenceEdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.DifferenceEdgeFeature" title="Permalink to this definition">#</a></dt>
<dd><p>Return the difference vector as the edge features.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.DistancePowerEdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">DistancePowerEdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_rescale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#DistancePowerEdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.DistancePowerEdgeFeature" title="Permalink to this definition">#</a></dt>
<dd><p>Return powers of the distance as edge features.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.EdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">EdgeFeature</span></span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#EdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.EdgeFeature" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all edge features.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.GaussianEdgeFeature">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">GaussianEdgeFeature</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_gaussian</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#GaussianEdgeFeature"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.GaussianEdgeFeature" title="Permalink to this definition">#</a></dt>
<dd><p>Expand the distance in a Gaussian basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_gaussian</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the number of gaussians to use,
consequently the length of the feature vector</p></li>
<li><p><strong>radius</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a>) – the radius within which to place gaussians</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – whether to offset the position of the first
Gaussian from zero.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="electrongnn">
<h3>ElectronGNN<a class="headerlink" href="#electrongnn" title="Permalink to this heading">#</a></h3>
<p>This submodule provides the ElectronGNN architecture for defining neural network
parametrized functions acting on graphs of electrons and nuclei.</p>
<span class="target" id="module-deepqmc.gnn.electron_gnn"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.ElectronEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.electron_gnn.</span></span><span class="sig-name descname"><span class="pre">ElectronEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_elec_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_types</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">positional_embeddings</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">project_to_embedding_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#ElectronEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.ElectronEmbedding" title="Permalink to this definition">#</a></dt>
<dd><p>Create initial embeddings for electrons.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.ElectronGNN">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.electron_gnn.</span></span><span class="sig-name descname"><span class="pre">ElectronGNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_particle_stream_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuclei_embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">electron_embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer_factory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ghost_coords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#ElectronGNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.ElectronGNN" title="Permalink to this definition">#</a></dt>
<dd><p>A neural network acting on graphs defined by electrons and nuclei.</p>
<p>Derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">GraphNeuralNetwork</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<a class="reference internal" href="#deepqmc.Molecule" title="deepqmc.Molecule"><code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code></a>) – the molecule on which the graph is defined.</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the length of the electron embedding vectors.</p></li>
<li><p><strong>n_interactions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – number of message passing interactions.</p></li>
<li><p><strong>positional_electron_embeddings</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – whether to initialize the electron
embbedings with the concatenated edge features.</p></li>
<li><p><strong>edge_features</strong> – a function or a <code class="xref py py-data docutils literal notranslate"><span class="pre">dict</span></code> of functions for each edge
type, embedding the interparticle differences.</p></li>
<li><p><strong>edge_types</strong> – the types of edges to consider in the molecular graph. It should
be a sequence of unique <code class="xref py py-data docutils literal notranslate"><span class="pre">str`s</span> <span class="pre">from</span> <span class="pre">the</span> <span class="pre">follwing</span> <span class="pre">options:</span>
<span class="pre">-</span> <span class="pre">`</span></code>’nn’<code class="docutils literal notranslate"><span class="pre">:</span> <span class="pre">nucleus-nucleus</span> <span class="pre">edges</span>
<span class="pre">-</span> <span class="pre">``'ne'</span></code>: nucleus-electron edges
- <code class="docutils literal notranslate"><span class="pre">'en'</span></code>: electron-nucleus edges
- <code class="docutils literal notranslate"><span class="pre">'same'</span></code>: electron-electron edges between electrons of the same spin
- <code class="docutils literal notranslate"><span class="pre">'anti'</span></code>: electron-electron edges between electrons of opposite spins</p></li>
<li><p><strong>two_particle_stream_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the feature dimension of the two particle
streams. Only active if <code class="xref py py-data docutils literal notranslate"><span class="pre">deep_features</span></code> are used.</p></li>
<li><p><strong>layer_factory</strong> (<em>Callable</em>) – a callable that generates a layer of the GNN.</p></li>
<li><p><strong>ghost_coords</strong> – optional, specifies the coordinates of one or more ghost atoms,
useful for breaking spatial symmetries of the nuclear geometry.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.ElectronGNN.edge_factory">
<span class="sig-name descname"><span class="pre">edge_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phys_conf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#ElectronGNN.edge_factory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.ElectronGNN.edge_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Compute all the graph edges used in the GNN.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.ElectronGNNLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.electron_gnn.</span></span><span class="sig-name descname"><span class="pre">ElectronGNNLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_interactions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ilayer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_interaction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_particle_stream_dim</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">one_particle_residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">two_particle_residual</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deep_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_rule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_factory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_factory_by_lbl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#ElectronGNNLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.ElectronGNNLayer" title="Permalink to this definition">#</a></dt>
<dd><p>The message passing layer of <a class="reference internal" href="#deepqmc.gnn.electron_gnn.ElectronGNN" title="deepqmc.gnn.electron_gnn.ElectronGNN"><code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronGNN</span></code></a>.</p>
<p>Derived from <code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassingLayer</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residual</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – whether a residual connection is used when updating
the electron embeddings.</p></li>
<li><p><strong>deep_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if <code class="xref py py-data docutils literal notranslate"><span class="pre">true</span></code> edge features are updated through
an MLP (<code class="xref py py-data docutils literal notranslate"><span class="pre">u</span></code>), else initial edge features are reused.</p></li>
<li><p><strong>update_features</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em>) – <p>which features to collect for the update
of the electron embeddings.
Possible values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'residual'</span></code>: electron embedding from the previous interaction layer</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'edge_ne'</span></code>: sum over messages from nuclei</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'edge_same'</span></code>: sum over messages from electrons with same spin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'edge_anti'</span></code>: sum over messages from electrons with opposite spin</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'edge_up'</span></code>: sum over messages from spin up electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'edge_down'</span></code>: sum over messages from spin down electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'edge_ee'</span></code>: sum of over messages from all electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'node_up'</span></code>: sum over embeddings from spin-up electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'node_down'</span></code>: sum over embeddings from spin-down electrons</p></li>
</ul>
</p></li>
<li><p><strong>update_rule</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – <p>how to combine features for the update of the
electron embeddings.
Possible values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'concatenate'</span></code>: run concatenated features through MLP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'featurewise'</span></code>: apply different MLP to each feature channel and sum</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'featurewise_shared'</span></code>: apply the same MLP across feature channels</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'sum'</span></code>: sum features before sending through an MLP</p></li>
</ul>
<p>note that <cite>sum</cite> and <cite>featurewise_shared</cite> imply features of same size</p>
</p></li>
<li><p><strong>subnet_factory</strong> (<em>Callable</em>) – A function that constructs the subnetworks of
the GNN layer.</p></li>
<li><p><strong>subnet_factory_by_lbl</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – optional, a dictionary of functions that construct
subnetworks of the GNN layer. If both this and <code class="xref py py-data docutils literal notranslate"><span class="pre">subnet_factory</span></code> is
specified, the specified values of <code class="xref py py-data docutils literal notranslate"><span class="pre">subnet_factory_by_lbl</span></code> will take
precedence. If some keys are missing, the default value of
<code class="xref py py-data docutils literal notranslate"><span class="pre">subnet_factory</span></code> will be used in their place. Possible keys are:
(<code class="xref py py-data docutils literal notranslate"><span class="pre">w</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">h</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">g</span></code> or <code class="xref py py-data docutils literal notranslate"><span class="pre">u</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.electron_gnn.NucleiEmbedding">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.electron_gnn.</span></span><span class="sig-name descname"><span class="pre">NucleiEmbedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_atom_types</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom_type_embedding</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subnet_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/electron_gnn.html#NucleiEmbedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.electron_gnn.NucleiEmbedding" title="Permalink to this definition">#</a></dt>
<dd><p>Create initial embeddings for nuclei.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>charges</strong> (<em>jnp.ndarray</em>) – the nuclear charges of the molecule.</p></li>
<li><p><strong>n_atom_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the number of different atom types in the molecule.</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – the length of the output embedding vector</p></li>
<li><p><strong>atom_type_embedding</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – if <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a>, initial embeddings are the same
for atoms of the same type (nuclear charge), otherwise they are different
for all nuclei.</p></li>
<li><p><strong>subnet_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – the type of subnetwork to use for the embedding generation:
- <code class="docutils literal notranslate"><span class="pre">'mlp'</span></code>: an MLP is used
- <code class="docutils literal notranslate"><span class="pre">'embed'</span></code>: a <a class="reference external" href="https://dm-haiku.readthedocs.io/en/latest/api.html#haiku.Embed" title="(in Haiku)"><code class="xref py py-class docutils literal notranslate"><span class="pre">haiku.Embed</span></code></a> block is used</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="tutorial.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Tutorial</p>
      </div>
    </a>
    <a class="right-next"
       href="refs.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">References</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=ac02cc09edc035673794"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=ac02cc09edc035673794"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2019-2023, Frank Noé and collaborators.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>