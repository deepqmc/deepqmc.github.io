
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API &#8212; DeepQMC 0.1.1 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/katex-math.css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js"></script>
    <script src="_static/katex_autorenderer.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="refs.html" />
    <link rel="prev" title="Tutorial" href="tutorial.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">DeepQMC</a></h1>



<p class="blurb">Deep-learning quantum Monte Carlo for electrons in real space</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=deepqmc&repo=deepqmc&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/deepqmc/deepqmc">
    <img
        alt="https://secure.travis-ci.org/deepqmc/deepqmc.svg?branch=master"
        src="https://secure.travis-ci.org/deepqmc/deepqmc.svg?branch=master"
    />
</a>
</p>




    

<p>
<a class="badge" href="https://codecov.io/github/deepqmc/deepqmc">
    <img
    alt="https://codecov.io/github/deepqmc/deepqmc/coverage.svg?branch=master"
    src="https://codecov.io/github/deepqmc/deepqmc/coverage.svg?branch=master"
    />
</a>
</p>
<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorial.html">Tutorial</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-deepqmc">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-deepqmc.wf">Wave functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#paulinet">PauliNet</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="refs.html">References</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="tutorial.html" title="previous chapter">Tutorial</a></li>
      <li>Next: <a href="refs.html" title="next chapter">References</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="api">
<span id="id1"></span><h1>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h1>
<p>The API is designed in such a way that entering it via the top-level <a class="reference internal" href="#deepqmc.train" title="deepqmc.train"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepqmc.train()</span></code></a> and <a class="reference internal" href="#deepqmc.wf.PauliNet.from_hf" title="deepqmc.wf.PauliNet.from_hf"><code class="xref py py-func docutils literal notranslate"><span class="pre">deepqmc.wf.PauliNet.from_hf()</span></code></a> entry points enables complete specification of all parameters via nested dictionaries that can be encoded in a <a class="reference external" href="https://github.com/toml-lang/toml">TOML</a> file. The lower-level dictionaries (stored under <code class="docutils literal notranslate"><span class="pre">*_kwargs</span></code> keys) are gradually unwrapped and passed into lower-level API components.</p>
<p>All classes documented below with a Shape section are derived from <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a> and are to be used as such.</p>
<div class="section" id="module-deepqmc">
<span id="training"></span><h2>Training<a class="headerlink" href="#module-deepqmc" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="deepqmc.evaluate">
<code class="sig-prename descclassname">deepqmc.</code><code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wf</span></em>, <em class="sig-param"><span class="n">store_steps</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">workdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">n_steps</span><span class="o">=</span><span class="default_value">500</span></em>, <em class="sig-param"><span class="n">sample_size</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">sample_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sampler_kwargs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/evaluate.html#evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a wave function model.</p>
<p>This is a top-level API function that rigorously evaluates a trained wave
function model. It initializes a <a class="reference internal" href="#deepqmc.sampling.LangevinSampler" title="deepqmc.sampling.LangevinSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">LangevinSampler</span></code></a>,
sets up a Tensorboard writer, and calls <a class="reference internal" href="#deepqmc.sampling.sample_wf" title="deepqmc.sampling.sample_wf"><code class="xref py py-func docutils literal notranslate"><span class="pre">sample_wf()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wf</strong> (<a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaveFunction</span></code></a>) – wave function model to be evaluated</p></li>
<li><p><strong>store_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to store individual sampled electron configuraitons</p></li>
<li><p><strong>workdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – path where to store Tensorboard event file and HDF5 file with
sampling block energies</p></li>
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of sampling steps</p></li>
<li><p><strong>sample_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of Markov-chain walkers</p></li>
<li><p><strong>n_decorrelate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of extra steps between samples included
in the expectation value averaging</p></li>
<li><p><strong>sampler_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – extra arguments passed to
<a class="reference internal" href="#deepqmc.sampling.LangevinSampler" title="deepqmc.sampling.LangevinSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">LangevinSampler</span></code></a></p></li>
<li><p><strong>sample_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – extra arguments passed to
<a class="reference internal" href="#deepqmc.sampling.sample_wf" title="deepqmc.sampling.sample_wf"><code class="xref py py-func docutils literal notranslate"><span class="pre">sample_wf()</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Expectation values with standard errors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="deepqmc.train">
<code class="sig-prename descclassname">deepqmc.</code><code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wf</span></em>, <em class="sig-param"><span class="n">workdir</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">save_every</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">state</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_rewind</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">blowup_threshold</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">raise_blowup</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">return_every</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chkpts</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">n_steps</span><span class="o">=</span><span class="default_value">10000</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="o">=</span><span class="default_value">10000</span></em>, <em class="sig-param"><span class="n">epoch_size</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">optimizer</span><span class="o">=</span><span class="default_value">'AdamW'</span></em>, <em class="sig-param"><span class="n">learning_rate</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">optimizer_kwargs</span><span class="o">=</span><span class="default_value">{'Adam': {'betas': [0.9, 0.9]}, 'AdamW': {'betas': [0.9, 0.9], 'weight_decay': 0.01}}</span></em>, <em class="sig-param"><span class="n">lr_scheduler</span><span class="o">=</span><span class="default_value">'CyclicLR'</span></em>, <em class="sig-param"><span class="n">lr_scheduler_kwargs</span><span class="o">=</span><span class="default_value">{'CyclicLR': {'base_lr': 0.0001, 'cycle_momentum': False, 'max_lr': 0.01, 'mode': 'triangular2', 'step_size_up': 250}, 'OneCycleLR': {'anneal_strategy': 'linear', 'max_lr': 0.005, 'pct_start': 0.075, 'total_steps': 5000}, 'inverse': {'decay_rate': 200}, 'scan': {'eq_steps': 100, 'rate': 1.05, 'start': 0.1}}</span></em>, <em class="sig-param"><span class="n">equilibrate</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fit_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">sampler_kwargs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/train.html#train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a wave function model.</p>
<p>This is the main top-level entry point of the DeepQMC package. This function
initializes a <a class="reference internal" href="#deepqmc.sampling.LangevinSampler" title="deepqmc.sampling.LangevinSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">LangevinSampler</span></code></a>, an optimizer, a
learning rate scheduler, optionally restores a previously stored training
state, sets up a Tensorboard writer, and calls <a class="reference internal" href="#deepqmc.fit.fit_wf" title="deepqmc.fit.fit_wf"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_wf()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wf</strong> (<a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaveFunction</span></code></a>) – wave function model to be trained</p></li>
<li><p><strong>workdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – path where to store Tensorboard event file, intermediate
parameter states, and HDF5 file with the fit trajectory</p></li>
<li><p><strong>save_every</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of steps between storing current parameter state</p></li>
<li><p><strong>state</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – restore optimizer and scheduler states from a stored state</p></li>
<li><p><strong>n_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of optimization steps</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of samples used in a single step</p></li>
<li><p><strong>epoch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of steps between sampling from the wave function</p></li>
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – name of the optimizer from <a class="reference external" href="https://pytorch.org/docs/stable/optim.html#module-torch.optim" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.optim</span></code></a></p></li>
<li><p><strong>learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – learning rate for gradient-descent optimizers</p></li>
<li><p><strong>optimizer_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – extra arguments passed to the optimizers, organized
by optimizer name</p></li>
<li><p><strong>lr_scheduler</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>name of the learning rate scheduling scheme</p>
<ul>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a> – no learning rate scheduling</p></li>
<li><p>uppercase name – name from <code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'inverse'</span></code> – <span class="math">\(\mathrm{lr}(n):=1/(1+n/r)\)</span>, where <em>r</em>
is decay rate</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'scan'</span></code> – <span class="math">\(\mathrm{lr})(n):=sr^{n-n_0}\)</span></p></li>
</ul>
</p></li>
<li><p><strong>lr_scheduler_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – extra arguments passed to the scheduler,
organized by scheduler name</p></li>
<li><p><strong>equilibrate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to equilibrate sampler before training</p></li>
<li><p><strong>fit_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – arguments passed to <a class="reference internal" href="#deepqmc.fit.fit_wf" title="deepqmc.fit.fit_wf"><code class="xref py py-func docutils literal notranslate"><span class="pre">fit_wf()</span></code></a></p></li>
<li><p><strong>sampler_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – arguments passed to
<a class="reference internal" href="#deepqmc.sampling.LangevinSampler" title="deepqmc.sampling.LangevinSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">LangevinSampler</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-deepqmc.fit"></span><dl class="py function">
<dt id="deepqmc.fit.fit_wf">
<code class="sig-prename descclassname">deepqmc.fit.</code><code class="sig-name descname">fit_wf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wf</span></em>, <em class="sig-param"><span class="n">loss_func</span></em>, <em class="sig-param"><span class="n">opt</span></em>, <em class="sig-param"><span class="n">sampler</span></em>, <em class="sig-param"><span class="n">steps</span></em>, <em class="sig-param"><span class="n">writer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">require_energy_gradient</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">require_psi_gradient</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">subbatch_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">max_memory</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">clip_outliers</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">q</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">max_grad_norm</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kfac</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/fit.html#fit_wf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.fit.fit_wf" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a wave function using the variational principle and gradient descent.</p>
<p>This is a low-level interface, see <a class="reference internal" href="#deepqmc.train" title="deepqmc.train"><code class="xref py py-func docutils literal notranslate"><span class="pre">train()</span></code></a> for a high-level
interface. This iterator iteratively draws samples from the sampler, evaluates
the local energy, processes outliers, calculates the loss function, and updates
the wave function model parameters using a gradient of the loss and an
optimizer. Diagnostics is written into the Tensorboard writer, and finally
at the end of each iteration the step index is yielded, so that the caller
can do some additional processing such as learning rate scheduling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wf</strong> (<a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaveFunction</span></code></a>) – wave function model to be fitted</p></li>
<li><p><strong>loss_func</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">WaveFunctionLoss</span></code>) – loss function that accepts local
energy and wave function values</p></li>
<li><p><strong>opt</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></a>) – optimizer</p></li>
<li><p><strong>sampler</strong> (<em>iterator</em>) – yields batches of electron coordinate samples</p></li>
<li><p><strong>steps</strong> (<em>iterator</em>) – yields step indexes</p></li>
<li><p><strong>writer</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensorboard.html#torch.utils.tensorboard.writer.SummaryWriter" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.tensorboard.writer.SummaryWriter</span></code></a>) – Tensorboard writer</p></li>
<li><p><strong>log_dict</strong> (<em>dict-like</em>) – batch data will be stored in this dictionary if given</p></li>
<li><p><strong>require_energy_gradient</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether the loss function requires
gradients of the local energy</p></li>
<li><p><strong>require_psi_gradient</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether the loss function requires
gradients of the wave function</p></li>
<li><p><strong>subbatch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of samples for a single vectorized loss evaluation.
If None and on a GPU, subbatch_size is estimated, else if None and on a CPU,
no subbatching is done.</p></li>
<li><p><strong>max_memory</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – maximum amount of allocated GPU memory (MiB) to be
considered if automatically estimating the subbatch_size. If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>
and subbatch_size is estimated, the maximum memory is set to the total
free GPU memory. When training on CPU always set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.8)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>.</p></li>
<li><p><strong>clip_outliers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to clip local energy outliers</p></li>
<li><p><strong>q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – multiple of MAE defining outliers</p></li>
<li><p><strong>max_grad_norm</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – maximum gradient norm passed to
<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.utils.clip_grad_norm_.html#torch.nn.utils.clip_grad_norm_" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-func docutils literal notranslate"><span class="pre">torch.nn.utils.clip_grad_norm_()</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-deepqmc.sampling"></span><dl class="py class">
<dt id="deepqmc.sampling.LangevinSampler">
<em class="property">class </em><code class="sig-prename descclassname">deepqmc.sampling.</code><code class="sig-name descname">LangevinSampler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wf</span></em>, <em class="sig-param"><span class="n">rs</span></em>, <em class="sig-param"><span class="n">writer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">tau</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">n_first_certain</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">target_acceptance</span><span class="o">=</span><span class="default_value">0.57</span></em>, <em class="sig-param"><span class="n">n_discard</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">n_decorrelate</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_age</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_psi_threshold</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#LangevinSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.sampling.LangevinSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples electronic wave functions with Langevin Monte Carlo.</p>
<p>Derived from <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt id="deepqmc.sampling.MetropolisSampler">
<em class="property">class </em><code class="sig-prename descclassname">deepqmc.sampling.</code><code class="sig-name descname">MetropolisSampler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wf</span></em>, <em class="sig-param"><span class="n">rs</span></em>, <em class="sig-param"><span class="n">writer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">tau</span><span class="o">=</span><span class="default_value">0.1</span></em>, <em class="sig-param"><span class="n">n_first_certain</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">target_acceptance</span><span class="o">=</span><span class="default_value">0.57</span></em>, <em class="sig-param"><span class="n">n_discard</span><span class="o">=</span><span class="default_value">50</span></em>, <em class="sig-param"><span class="n">n_decorrelate</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">max_age</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">log_psi_threshold</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#MetropolisSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.sampling.MetropolisSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples electronic wave functions with vanilla Metropolis–Hastings Monte Carlo.</p>
<p>An instance of this class is an iterator that yields 2-tuples of electron
coordinates and wave function values with shapes of <span class="math">\((\cdot,N,3)\)</span> and
<span class="math">\((\cdot)\)</span>, respectively.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wf</strong> (<a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaveFunction</span></code></a>) – wave function to sample from</p></li>
<li><p><strong>rs</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a><span class="math">\((\cdot,N,3)\)</span>) – initial positions of the
Markov-chain walkers</p></li>
<li><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – <span class="math">\(\tau\)</span>, proposal step size</p></li>
<li><p><strong>n_first_certain</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of initial steps done with 100% acceptance</p></li>
<li><p><strong>target_acceptance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – initial step size is automatically adjusted
to achieve this requested acceptance</p></li>
<li><p><strong>n_discard</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of steps in the beginning of the sampling that are
discarded</p></li>
<li><p><strong>n_decorrelate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of extra steps between yielded samples</p></li>
<li><p><strong>max_age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – maximum age of a walker without a move after which it is
moved with 100% acceptance</p></li>
<li><p><strong>log_psi_threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – steps into proposals with log wave function values
below this threshold are always rejected</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="deepqmc.sampling.MetropolisSampler.from_mf">
<em class="property">classmethod </em><code class="sig-name descname">from_mf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wf</span></em>, <em class="sig-param"><span class="n">mf</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">sample_size</span><span class="o">=</span><span class="default_value">2000</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#MetropolisSampler.from_mf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.sampling.MetropolisSampler.from_mf" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a sampler from a HF calculation.</p>
<p>The initial walker positions are sampled from Gaussians centered
on atoms, with charge distribution corresponding to the charge analysis
of the HF wave function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wf</strong> (<a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaveFunction</span></code></a>) – wave function to be sampled from</p></li>
<li><p><strong>mf</strong> (<a class="reference external" href="http://pyscf.org/pyscf/scf.html#pyscf.scf.hf.RHF" title="(in PySCF v1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.scf.hf.RHF</span></code></a>) – HF calculation used to get Mulliken
partial charges, taken from <code class="docutils literal notranslate"><span class="pre">wf.mf</span></code> if not given</p></li>
<li><p><strong>sample_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of Markov-chain walkers</p></li>
<li><p><strong>kwargs</strong> – all other arguments are passed to the constructor</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="deepqmc.sampling.MetropolisSampler.iter_batches">
<code class="sig-name descname">iter_batches</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">epoch_size</em>, <em class="sig-param">batch_size</em>, <em class="sig-param">range=&lt;class 'range'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#MetropolisSampler.iter_batches"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.sampling.MetropolisSampler.iter_batches" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over buffered batches sampled in epochs.</p>
<p>Each epoch, the wave function is sampled in one shot, the samples
are buffered, and used to form all batches within a given epoch, entirely
shuffled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of batches per epoch</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of samples in a batch</p></li>
<li><p><strong>range</strong> (<em>callable</em>) – alternative to <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#range" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">range</span></code></a></p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="deepqmc.sampling.sample_wf">
<code class="sig-prename descclassname">deepqmc.sampling.</code><code class="sig-name descname">sample_wf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wf</span></em>, <em class="sig-param"><span class="n">sampler</span></em>, <em class="sig-param"><span class="n">steps</span></em>, <em class="sig-param"><span class="n">writer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">write_figures</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">log_dict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">blocks</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">block_size</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">equilibrate</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#sample_wf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.sampling.sample_wf" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a wave function and accumulate expectation values.</p>
<p>This is a low-level interface, see <a class="reference internal" href="#deepqmc.evaluate" title="deepqmc.evaluate"><code class="xref py py-func docutils literal notranslate"><span class="pre">evaluate()</span></code></a> for a high-level
interface. This iterator iteratively draws samples from the sampler, detects
when equilibrium is reached, and starts calculating and accumulating
local energies to get an estimate of the energy. Diagnostics is written into
the Tensorboard writer, and every full block, the step index, the current
estimate of the energy, and the sampled electron coordinates are yielded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wf</strong> (<a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaveFunction</span></code></a>) – wave function model to be sampled</p></li>
<li><p><strong>sampler</strong> (<em>iterator</em>) – yields batches of electron coordinate samples</p></li>
<li><p><strong>steps</strong> (<em>iterator</em>) – yields step indexes</p></li>
<li><p><strong>writer</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensorboard.html#torch.utils.tensorboard.writer.SummaryWriter" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.tensorboard.writer.SummaryWriter</span></code></a>) – Tensorboard writer</p></li>
<li><p><strong>log_dict</strong> (<em>dict-like</em>) – step data will be stored in this dictionary if given</p></li>
<li><p><strong>blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – used as storage of blocks. If not given, the iterator
uses a local storage.</p></li>
<li><p><strong>block_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size of a block (a sequence of samples)</p></li>
<li><p><strong>equilibrate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – if false, local energies are calculated and
accumulated from the first sampling step, if true equilibrium is
detected automatically, if integer argument, specifies number of
equilibration steps</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-deepqmc.wf">
<span id="wave-functions"></span><h2>Wave functions<a class="headerlink" href="#module-deepqmc.wf" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="deepqmc.wf.WaveFunction">
<em class="property">class </em><code class="sig-prename descclassname">deepqmc.wf.</code><code class="sig-name descname">WaveFunction</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/base.html#WaveFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.wf.WaveFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all trial wave functions.</p>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input, <span class="math">\(\mathbf r\)</span>, a.u.: <span class="math">\((\cdot,N,3)\)</span></p></li>
<li><p>Output1, <span class="math">\(\ln|\psi(\mathbf r)|\)</span>: <span class="math">\((\cdot)\)</span></p></li>
<li><p>Output2, <span class="math">\(\operatorname{sgn}\psi(\mathbf r)\)</span>: <span class="math">\((\cdot)\)</span></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="section" id="paulinet">
<h3>PauliNet<a class="headerlink" href="#paulinet" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="deepqmc.wf.PauliNet">
<em class="property">class </em><code class="sig-prename descclassname">deepqmc.wf.</code><code class="sig-name descname">PauliNet</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/paulinet/paulinet.html#PauliNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.wf.PauliNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Implements the PauliNet ansatz from <a class="reference internal" href="refs.html#hermann19" id="id2"><span>[Hermann19]</span></a>.</p>
<p>Derived from <a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">WaveFunction</span></code></a>. This constructor provides a fully
flexible low-level interface. See the alternative constructors for the
high-level interfaces.</p>
<p>The PauliNet ansatz combines a multireference Slater determinant expansion,
Gaussian-type cusp-corrected molecular orbitals (<code class="xref py py-class docutils literal notranslate"><span class="pre">MolecularOrbital</span></code>),
electronic cusp Jastrow factor (<code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronicAsymptotic</span></code>) and many-body
Jastrow factor and backflow transformation represented by neural networks
that use featurized particle distances,
<span class="math">\(\mathbf e(|\mathbf r-\mathbf r'|)\)</span> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DistanceBasis</span></code>), as input,</p>
<div class="math">
\[\psi_{\boldsymbol\theta}(\mathbf r)
  =\mathrm e^{\gamma(\mathbf r)+J_{\boldsymbol\theta}(\mathbf r)}
  \sum_{pq} c_p
  \det[\tilde\varphi_{\boldsymbol\theta,q{\mu_p}i}^\uparrow(\mathbf r)]
  \det[\tilde\varphi_{\boldsymbol\theta,q{\mu_p}i}^\downarrow(\mathbf r)] \\
\tilde\varphi_{\boldsymbol\theta,q\mu i}(\mathbf r)
  :=\big(1+2\tanh(\kappa_{\boldsymbol\theta,q\mu i}(\mathbf r))\big)
  \varphi_\mu(\mathbf r_i)

\]</div>
<p>Here, <span class="math">\(c_p,\mu_p\)</span> define the multideterminant expansion,
<span class="math">\(\varphi_\mu(\mathbf r)\)</span> are the baseline
single-electron molecular orbitals, <span class="math">\(J_{\boldsymbol\theta}(\mathbf r)\)</span>
is the permutation-invariant deep Jastrow factor,
<span class="math">\(\kappa_{\boldsymbol\theta,q\mu i}(\mathbf r)\)</span> is the <span class="math">\(q\)</span>-th
channel of the permutation-equivariant deep backflow, and <span class="math">\(\gamma\)</span>
enforces correct electronic cusp conditions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>) – molecule whose wave function is represented</p></li>
<li><p><strong>basis</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">GTOBasis</span></code>) – basis for the molecular orbitals</p></li>
<li><p><strong>jastrow_factory</strong> (<em>callable</em>) – constructor for a Jastrow factor,
<span class="math">\((M,\dim(\mathbf e),N^\uparrow,N^\downarrow)\)</span>
<span class="math">\(\rightarrow(\mathbf e_{ij},\mathbf e_{iI})\rightarrow J\)</span></p></li>
<li><p><strong>backflow_factory</strong> (<em>callable</em>) – constructor for a backflow,
<span class="math">\((M,\dim(\mathbf e),N^\uparrow,N^\downarrow,N_\text{orb},C)\)</span>
<span class="math">\(\rightarrow(\mathbf e_{ij},\mathbf e_{iI})\)</span>
<span class="math">\(\rightarrow\kappa_{q\mu i}\)</span></p></li>
<li><p><strong>omni_factory</strong> (<em>callable</em>) – constructor for a combined Jastrow factor and backflow,
with interface identical to <code class="xref py py-class docutils literal notranslate"><span class="pre">OmniSchNet</span></code></p></li>
<li><p><strong>n_configurations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of electron configurations</p></li>
<li><p><strong>n_orbitals</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of distinct molecular orbitals used across all
configurations if given, otherwise the larger of the number of spin-up
and spin-down electrons</p></li>
<li><p><strong>mo_factory</strong> (<em>callable</em>) – passed to <code class="xref py py-class docutils literal notranslate"><span class="pre">MolecularOrbital</span></code>
as <code class="docutils literal notranslate"><span class="pre">net_factory</span></code></p></li>
<li><p><strong>cusp_correction</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether nuclear cusp correction is used</p></li>
<li><p><strong>cusp_electrons</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether electronic cusp function is used</p></li>
<li><p><strong>dist_feat_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <span class="math">\(\dim(\mathbf e)\)</span>, number of distance features</p></li>
<li><p><strong>dist_feat_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>a.u.</em>) – distance at which distance features
go to zero</p></li>
<li><p><strong>backflow_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <span class="math">\(C\)</span>, number of backflow channels</p></li>
</ul>
</dd>
<dt class="field-even">Variables</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>jastrow</strong> – <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a> representing the Jastrow factor</p></li>
<li><p><strong>backflow</strong> – <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></a> representing the backflow transformation</p></li>
<li><p><strong>conf_coeff</strong> – <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Linear.html#torch.nn.Linear" title="(in PyTorch v&lt;a href='http://pytorch.org/docs/versions.html'&gt;1.6.0 &amp;#x25BC&lt;/a&gt;)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.Linear</span></code></a> with no bias that represents
the multireference coefficients <span class="math">\(c_p\)</span> via its <code class="xref py py-attr docutils literal notranslate"><span class="pre">weight</span></code>
variable of shape <span class="math">\((1,N_\text{det})\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="deepqmc.wf.PauliNet.from_hf">
<em class="property">classmethod </em><code class="sig-name descname">from_hf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mol</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">basis</span><span class="o">=</span><span class="default_value">'6-311g'</span></em>, <em class="sig-param"><span class="n">cas</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pauli_kwargs</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">omni_kwargs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/paulinet/paulinet.html#PauliNet.from_hf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.wf.PauliNet.from_hf" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#deepqmc.wf.PauliNet" title="deepqmc.wf.PauliNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">PauliNet</span></code></a> instance by running a HF calculation.</p>
<p>This is the top-level interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Molecule</span></code>) – molecule whose wave function
is represented</p></li>
<li><p><strong>basis</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – basis of the internal HF calculation</p></li>
<li><p><strong>cas</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em>) – tuple of the number of active orbitals and number of
active electrons for a complete active space multireference
HF calculation</p></li>
<li><p><strong>pauli_kwargs</strong> – arguments passed to <a class="reference internal" href="#deepqmc.wf.PauliNet.from_pyscf" title="deepqmc.wf.PauliNet.from_pyscf"><code class="xref py py-func docutils literal notranslate"><span class="pre">PauliNet.from_pyscf()</span></code></a></p></li>
<li><p><strong>omni_kwargs</strong> – arguments passed to <code class="xref py py-class docutils literal notranslate"><span class="pre">OmniSchNet</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="deepqmc.wf.PauliNet.from_pyscf">
<em class="property">classmethod </em><code class="sig-name descname">from_pyscf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mf</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">init_weights</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">freeze_mos</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">freeze_confs</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">conf_cutoff</span><span class="o">=</span><span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">conf_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/paulinet/paulinet.html#PauliNet.from_pyscf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.wf.PauliNet.from_pyscf" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a <a class="reference internal" href="#deepqmc.wf.PauliNet" title="deepqmc.wf.PauliNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">PauliNet</span></code></a> instance from a finished <a class="reference external" href="http://pyscf.org">PySCF</a> calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mf</strong> (<a class="reference external" href="http://pyscf.org/pyscf/scf.html#pyscf.scf.hf.RHF" title="(in PySCF v1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.scf.hf.RHF</span></code></a> | <a class="reference external" href="http://pyscf.org/pyscf/mcscf.html#pyscf.mcscf.mc1step.CASSCF" title="(in PySCF v1.5)"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyscf.mcscf.mc1step.CASSCF</span></code></a>) – restricted (multireference) HF calculation</p></li>
<li><p><strong>init_weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether molecular orbital coefficients and
configuration coefficients are initialized from the HF calculation</p></li>
<li><p><strong>freeze_mos</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether the MO coefficients are frozen for
gradient optimization</p></li>
<li><p><strong>freeze_confs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether the configuration coefficients are
frozen for gradient optimization</p></li>
<li><p><strong>conf_cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – determinants with a linear coefficient above
this threshold are included in the determinant expansion</p></li>
<li><p><strong>conf_limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – if given, at maximum the given number of configurations
with the largest linear coefficients are used in the ansatz</p></li>
<li><p><strong>kwargs</strong> – all other arguments are passed to the <a class="reference internal" href="#deepqmc.wf.PauliNet" title="deepqmc.wf.PauliNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">PauliNet</span></code></a>
constructor</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-deepqmc.wf.paulinet"></span><dl class="py class">
<dt id="deepqmc.wf.paulinet.SubnetFactory">
<em class="property">class </em><code class="sig-prename descclassname">deepqmc.wf.paulinet.</code><code class="sig-name descname">SubnetFactory</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dist_feat_dim</span></em>, <em class="sig-param"><span class="n">kernel_dim</span></em>, <em class="sig-param"><span class="n">embedding_dim</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">n_layers_w</span><span class="o">=</span><span class="default_value">2</span></em>, <em class="sig-param"><span class="n">n_layers_h</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">n_layers_g</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/paulinet/schnet.html#SubnetFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.wf.paulinet.SubnetFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates subnetworks for <code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronicSchNet</span></code>.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">ElectronicSchNet</span></code> constructor expects this class constructor. To
change the default subnetwork depths, use <a class="reference external" href="https://docs.python.org/3/library/functools.html#functools.partial" title="(in Python v3.8)"><code class="xref py py-func docutils literal notranslate"><span class="pre">functools.partial()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dist_feat_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <span class="math">\(\dim(\mathbf e)\)</span>, number of distance features</p></li>
<li><p><strong>kernel_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <span class="math">\(\dim(\mathbf w)\)</span>, dimension of the convolution kernel</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <span class="math">\(\dim(\mathbf X)\)</span>, dimension of electron embeddings</p></li>
<li><p><strong>n_layers_w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of layers in the <span class="math">\(\mathbf w\)</span> networks</p></li>
<li><p><strong>n_layers_h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of layers in the <span class="math">\(\mathbf h\)</span> networks</p></li>
<li><p><strong>n_layers_g</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of layers in the <span class="math">\(\mathbf g\)</span> networks</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="deepqmc.wf.paulinet.SubnetFactory.g_subnet">
<code class="sig-name descname">g_subnet</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/paulinet/schnet.html#SubnetFactory.g_subnet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.wf.paulinet.SubnetFactory.g_subnet" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the <span class="math">\(\mathbf g\)</span> network.</p>
</dd></dl>

<dl class="py method">
<dt id="deepqmc.wf.paulinet.SubnetFactory.h_subnet">
<code class="sig-name descname">h_subnet</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/paulinet/schnet.html#SubnetFactory.h_subnet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.wf.paulinet.SubnetFactory.h_subnet" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the <span class="math">\(\mathbf h\)</span> network.</p>
</dd></dl>

<dl class="py method">
<dt id="deepqmc.wf.paulinet.SubnetFactory.w_subnet">
<code class="sig-name descname">w_subnet</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/paulinet/schnet.html#SubnetFactory.w_subnet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#deepqmc.wf.paulinet.SubnetFactory.w_subnet" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the <span class="math">\(\mathbf w\)</span> network.</p>
</dd></dl>

</dd></dl>

</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2019-2020, Frank Noé and collaborators.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>