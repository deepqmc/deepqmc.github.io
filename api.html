
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>API &#8212; DeepQMC 1.0.0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.3/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="_static/katex-math.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/katex.min.js"></script>
    <script src="_static/auto-render.min.js"></script>
    <script src="_static/katex_autorenderer.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'api';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="References" href="refs.html" />
    <link rel="prev" title="Command-line interface" href="cli.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="index.html">

  
  
  
  
  
  
  

  
  
    <p class="title logo__title">DeepQMC 1.0.0 documentation</p>
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="tutorial.html">
                        Tutorial
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="cli.html">
                        Command-line interface
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="refs.html">
                        References
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/deepqmc/deepqmc" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="installation.html">
                        Installation
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="tutorial.html">
                        Tutorial
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="cli.html">
                        Command-line interface
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="#">
                        API
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="refs.html">
                        References
                      </a>
                    </li>
                
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          <a href="https://github.com/deepqmc/deepqmc" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-toggle="tooltip"><span><i class="fa-brands fa-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#haiku">
   Haiku
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#module-deepqmc.train">
   Training and evaluation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#sampling">
   Sampling
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wave-functions">
   Wave functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#graph-neural-networks">
   Graph neural networks
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#graphs">
     Graphs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gnns">
     GNNs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#schnet">
     SchNet
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        
        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                
            </div>
            
            
            <article class="bd-article" role="main">
              
  <section id="id1">
<h1>API<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<p>This is the documentation of the API of the JAX implementation of the <a class="reference internal" href="#module-deepqmc" title="deepqmc"><code class="xref py py-class docutils literal notranslate"><span class="pre">deepqmc</span></code></a> package.</p>
<p>This implementation uses the <a class="reference external" href="https://github.com/google/jax">JAX library</a>, the documentation for which can be found here:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://jax.readthedocs.io/en/latest">JAX documentation</a></p></li>
</ul>
<span class="target" id="module-deepqmc"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.Molecule">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.</span></span><span class="sig-name descname"><span class="pre">Molecule</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">charge</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bohr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/molecule.html#Molecule"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.Molecule" title="Permalink to this definition">#</a></dt>
<dd><p>Represents a molecule.</p>
<p>The array-like arguments accept anything that can be transformed to
<code class="xref py py-class docutils literal notranslate"><span class="pre">jax.numpy.DeviceArray</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (float, (<span class="math">\(N_\text{nuc}\)</span>, 3), a.u.) – nuclear coordinates as rows</p></li>
<li><p><strong>charges</strong> (int, (<span class="math">\(N_\text{nuc}\)</span>)) – atom charges</p></li>
<li><p><strong>charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – total charge of a molecule</p></li>
<li><p><strong>spin</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – total spin multiplicity</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.Molecule.from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/molecule.html#Molecule.from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.Molecule.from_name" title="Permalink to this definition">#</a></dt>
<dd><p>Create a molecule from a database of named molecules.</p>
<p>The available names are in <code class="xref py py-attr docutils literal notranslate"><span class="pre">Molecule.all_names</span></code>.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepqmc.Molecule.n_particles">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_particles</span></span><a class="headerlink" href="#deepqmc.Molecule.n_particles" title="Permalink to this definition">#</a></dt>
<dd><p>Return the number of nuclei, spin-up, and spin-down electrons.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-deepqmc.hamil"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hamil.Hamiltonian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hamil.</span></span><span class="sig-name descname"><span class="pre">Hamiltonian</span></span><a class="reference internal" href="_modules/deepqmc/hamil/base.html#Hamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.Hamiltonian" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all Hamiltonian operators.</p>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.hamil.Hamiltonian.local_energy">
<span class="sig-name descname"><span class="pre">local_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil/base.html#Hamiltonian.local_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.Hamiltonian.local_energy" title="Permalink to this definition">#</a></dt>
<dd><p>Return a function that calculates the local energy of the wave function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>wf</strong> (<em>WaveFunction</em>) – the wave function ansatz.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>a function that evaluates
the local energy of <code class="xref py py-data docutils literal notranslate"><span class="pre">wf</span></code> at <code class="xref py py-data docutils literal notranslate"><span class="pre">r</span></code>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Callable[r,</span> <span class="pre">...]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hamil.MolecularHamiltonian">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hamil.</span></span><span class="sig-name descname"><span class="pre">MolecularHamiltonian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mol</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil/qc.html#MolecularHamiltonian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.MolecularHamiltonian" title="Permalink to this definition">#</a></dt>
<dd><p>Hamiltonian of non-relativistic molecular systems.</p>
<p>The system consists of nuclei with fixed positions and electrons moving
around them. The total energy is defined as the sum of the nuclear-nuclear
and electron-electron repulsion, the nuclear-electron attraction, and the
kinetic energy of the electrons:
<span class="math">\(E=V_\text{nuc-nuc} + V_\text{el-el} + V_\text{nuc-el} + E_\text{kin}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mol</strong> (<em>Molecule</em>) – the molecule to consider</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.hamil.MolecularHamiltonian.init_sample">
<span class="sig-name descname"><span class="pre">init_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rng</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">elec_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hamil/qc.html#MolecularHamiltonian.init_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hamil.MolecularHamiltonian.init_sample" title="Permalink to this definition">#</a></dt>
<dd><p>Guess some initial electron positions.</p>
<p>Tries to make an educated guess about plausible initial electron
configurations. Places electrons according to normal distributions
centered on the nuclei. If the molecule is not neutral, extra electrons
are placed on or removed from random nuclei. The resulting configurations
are usually very crude, a subsequent, thorough equilibration is needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rng</strong> (<em>jax.random.PRNGKey</em>) – key used for PRNG.</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the number of configurations to generate.</p></li>
<li><p><strong>elec_std</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – optional, a factor for scaling the spread of
electrons around the nuclei.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<section id="haiku">
<h2>Haiku<a class="headerlink" href="#haiku" title="Permalink to this heading">#</a></h2>
<p>The JAX implementation uses the <a class="reference external" href="https://github.com/deepmind/dm-haiku">haiku library</a> to create, train and evaluate neural network models.
Some additional neural network functionality is implemented in the package and documented here.</p>
<span class="target" id="module-deepqmc.hkext"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.hkext.MLP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">MLP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#MLP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.MLP" title="Permalink to this definition">#</a></dt>
<dd><p>Represent a multilayer perceptron.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the input dimension.</p></li>
<li><p><strong>out_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the output dimension.</p></li>
<li><p><strong>hidden_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)"><em>tuple</em></a>) – optional, either (‘log’, <span class="math">\(N_\text{layers}\)</span>),
in which case the network will have <span class="math">\(N_\text{layers}\)</span> layers
with logarithmically changing widths, or a tuple of ints specifying
the width of each layer.</p></li>
<li><p><strong>bias</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – <p>optional, specifies which layers should have a bias term.
Possible values are</p>
<ul>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a>: all layers will have a bias term</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>: no layers will have a bias term</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'not_last'</span></code>: all but the last layer will have a bias term</p></li>
</ul>
</p></li>
<li><p><strong>last_linear</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – optional, if <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">True</span></code></a> the activation function
is not applied to the activation of the last layer.</p></li>
<li><p><strong>activation</strong> (<em>Callable</em>) – optional, the activation function.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – optional, the name of the network.</p></li>
<li><p><strong>w_init</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em> or </em><em>Callable</em>) – <p>optional, specifies the initialization of the
linear weights. Possible string values are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'default'</span></code>: the default haiku initialization method is used.</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'deeperwin'</span></code>: the initialization method of the <code class="xref py py-class docutils literal notranslate"><span class="pre">deeperwin</span></code></dt><dd><p>package is used.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.hkext.ssp">
<span class="sig-prename descclassname"><span class="pre">deepqmc.hkext.</span></span><span class="sig-name descname"><span class="pre">ssp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/hkext.html#ssp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.hkext.ssp" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the shifted softplus activation function.</p>
<p>Computes the elementwise function
<span class="math">\(\text{softplus}(x)=\log(1+\text{e}^x)+\log\frac{1}{2}\)</span></p>
</dd></dl>

</section>
<section id="module-deepqmc.train">
<span id="training-and-evaluation"></span><h2>Training and evaluation<a class="headerlink" href="#module-deepqmc.train" title="Permalink to this heading">#</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.train.train">
<span class="sig-prename descclassname"><span class="pre">deepqmc.train.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ansatz</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">workdir=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_state=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init_step=0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state_callback=&lt;function</span> <span class="pre">state_callback&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_restarts=3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_eq_steps=1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrain_steps=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pretrain_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">opt_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_kwargs=None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chkpts_kwargs=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/train.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.train.train" title="Permalink to this definition">#</a></dt>
<dd><p>Train or evaluate a JAX wave function model.</p>
<p>It initializes and equilibrates the MCMC sampling of the wave function ansatz,
then optimizes or samples it using the variational principle. It optionally
saves checkpoints and rewinds the training/evaluation if an error is encountered.
If an optimizer is supplied, the Ansatz is optimized, otherwise the Ansatz is
only sampled.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<a class="reference internal" href="#deepqmc.hamil.Hamiltonian" title="deepqmc.hamil.Hamiltonian"><em>Hamiltonian</em></a>) – the Hamiltonian of the physical system.</p></li>
<li><p><strong>ansatz</strong> (<a class="reference internal" href="#deepqmc.wf.WaveFunction" title="deepqmc.wf.WaveFunction"><em>WaveFunction</em></a>) – the wave function Ansatz.</p></li>
<li><p><strong>opt</strong> (<code class="docutils literal notranslate"><span class="pre">kfac_jax</span></code> or <code class="docutils literal notranslate"><span class="pre">optax</span></code> optimizers, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>) – <p>the optimizer. Possible values are:</p>
<ul>
<li><dl class="simple">
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">kfac_jax.Optimizer</span></code>: the partially initialized KFAC optimizer</dt><dd><p>is used</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>an <code class="xref py py-data docutils literal notranslate"><span class="pre">optax</span></code> optimizer instance: the supplied <code class="xref py py-data docutils literal notranslate"><span class="pre">optax</span></code></dt><dd><p>optimizer is used.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>: the name of the optimizer to use (<code class="xref py py-data docutils literal notranslate"><span class="pre">'kfac'</span></code> or an</dt><dd><p><code class="xref py py-data docutils literal notranslate"><span class="pre">optax</span></code> optimzier name). Arguments to the optimizer can be
passed in <code class="xref py py-data docutils literal notranslate"><span class="pre">opt_kwargs</span></code>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">None</span></code></a>: no optimizer is used, e.g. the evaluation of the Ansatz</dt><dd><p>is performed.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>sampler</strong> (<a class="reference internal" href="#deepqmc.sampling.Sampler" title="deepqmc.sampling.Sampler"><em>Sampler</em></a>) – a sampler instance</p></li>
<li><p><strong>workdir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – optional, path, where results and checkpoints should be saved.</p></li>
<li><p><strong>train_state</strong> (<em>TrainState</em>) – optional, training checkpoint to
restore training or run evaluation.</p></li>
<li><p><strong>init_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, initial step index, useful if
calculation is restarted from checkpoint saved on disk.</p></li>
<li><p><strong>state_callback</strong> (<em>Callable</em>) – optional, a function processing the <code class="xref py py-class docutils literal notranslate"><span class="pre">haiku</span></code>
state of the wave function Ansatz.</p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, number of optimization steps.</p></li>
<li><p><strong>sample_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the number of samples considered in a batch</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the seed used for PRNG.</p></li>
<li><p><strong>max_restarts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, the maximum number of times the training is
retried before a <code class="xref py py-class docutils literal notranslate"><span class="pre">NaNError</span></code> is raised.</p></li>
<li><p><strong>max_eq_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, maximum number of equilibration steps if not
detected earlier.</p></li>
<li><p><strong>pretrain_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, the number of pretraining steps wrt. to the
Baseline wave function obtained with pyscf.</p></li>
<li><p><strong>pretrain_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, extra arguments for pretraining.</p></li>
<li><p><strong>opt_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, extra arguments passed to the optimizer.</p></li>
<li><p><strong>fit_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, extra arguments passed to the <code class="xref py py-func docutils literal notranslate"><span class="pre">fit_wf()</span></code>
function.</p></li>
<li><p><strong>chkpts_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, extra arguments for checkpointing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-deepqmc.fit"></span></section>
<section id="sampling">
<h2>Sampling<a class="headerlink" href="#sampling" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.Sampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">Sampler</span></span><a class="reference internal" href="_modules/deepqmc/sampling.html#Sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.Sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all QMC samplers.</p>
</dd></dl>

<span class="target" id="module-deepqmc.sampling"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.DecorrSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">DecorrSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#DecorrSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.DecorrSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Insert decorrelating steps into chained samplers.</p>
<p>This sampler cannot be used as the last element of a sampler chain.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the samples will be taken in every <code class="xref py py-data docutils literal notranslate"><span class="pre">length</span></code> MCMC step,
that is, <code class="xref py py-data docutils literal notranslate"><span class="pre">length</span></code> <span class="math">\(-1\)</span> decorrelating steps are inserted.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.LangevinSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">LangevinSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#LangevinSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.LangevinSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Langevin Monte Carlo sampler.</p>
<p>Derived from <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a>.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.MetropolisSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">MetropolisSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hamil</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tau</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.57</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_age</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#MetropolisSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.MetropolisSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Metropolis–Hastings Monte Carlo sampler.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code> method of this class returns electron coordinate samples
from the distribution defined by the square of the sampled wave function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<em>jax.hamil.Hamiltonian</em>) – the Hamiltonian of the physical system</p></li>
<li><p><strong>tau</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – optional, the proposal step size scaling factor. Adjusted during
every step if <code class="xref py py-data docutils literal notranslate"><span class="pre">target_acceptance</span></code> is specified.</p></li>
<li><p><strong>target_acceptance</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – optional, if specified the proposal step size
will be scaled such that the ratio of accepted proposal steps approaches
<code class="xref py py-data docutils literal notranslate"><span class="pre">target_acceptance</span></code>.</p></li>
<li><p><strong>max_age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, if specified the next proposed step will always be
accepted for a walker that hasn’t moved in the last <code class="xref py py-data docutils literal notranslate"><span class="pre">max_age</span></code> steps.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.sampling.ResampledSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">ResampledSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#ResampledSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.ResampledSampler" title="Permalink to this definition">#</a></dt>
<dd><p>Add resampling to chained samplers.</p>
<p>This sampler cannot be used as the last element of a sampler chain.
The resampling is performed by accumulating weights on each MCMC walker
in each step. Based on a fixed resampling period <code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> and/or a
threshold <code class="xref py py-data docutils literal notranslate"><span class="pre">treshold</span></code> on the normalized effective sample size the walker
positions are sampled according to the multinomial distribution defined by
these weights, and the weights are reset to one. Either <code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> or
<code class="xref py py-data docutils literal notranslate"><span class="pre">treshold</span></code> have to be specified.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>period</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, if specified the walkers are resampled every
<code class="xref py py-data docutils literal notranslate"><span class="pre">period</span></code> MCMC steps.</p></li>
<li><p><strong>treshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – optional, if specified the walkers are resampled if
the effective sample size normalized with the batch size is below
<code class="xref py py-data docutils literal notranslate"><span class="pre">treshold</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.sampling.chain">
<span class="sig-prename descclassname"><span class="pre">deepqmc.sampling.</span></span><span class="sig-name descname"><span class="pre">chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">samplers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/sampling.html#chain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.sampling.chain" title="Permalink to this definition">#</a></dt>
<dd><p>Combine multiple sampler types, to create advanced sampling schemes.</p>
<p>For example <code class="xref py py-data docutils literal notranslate"><span class="pre">chain(DecorrSampler(10),MetropolisSampler(hamil,</span> <span class="pre">tau=1.))</span></code>
will create a <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a>, where the samples
are taken from every 10th MCMC step. The last element of the sampler chain has
to be either a <a class="reference internal" href="#deepqmc.sampling.MetropolisSampler" title="deepqmc.sampling.MetropolisSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetropolisSampler</span></code></a> or a <a class="reference internal" href="#deepqmc.sampling.LangevinSampler" title="deepqmc.sampling.LangevinSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">LangevinSampler</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>samplers</strong> (<em>Sampler</em>) – one or more sampler instances to combine.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the combined sampler.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><em>Sampler</em></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="wave-functions">
<h2>Wave functions<a class="headerlink" href="#wave-functions" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.wf.WaveFunction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.wf.</span></span><span class="sig-name descname"><span class="pre">WaveFunction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/base.html#WaveFunction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.wf.WaveFunction" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all trial wave functions.</p>
<dl class="simple">
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Input, <span class="math">\(\mathbf r\)</span>, (float, <span class="math">\((N,3)\)</span>, a.u.): particle</dt><dd><p>coordinates</p>
</dd>
</dl>
</li>
<li><p>Output1, <span class="math">\(\ln|\psi(\mathbf r)|\)</span> (float):</p></li>
<li><p>Output2, <span class="math">\(\operatorname{sgn}\psi(\mathbf r)\)</span> (float):</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.wf.PauliNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.wf.</span></span><span class="sig-name descname"><span class="pre">PauliNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/wf/paulinet/paulinet.html#PauliNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.wf.PauliNet" title="Permalink to this definition">#</a></dt>
<dd><p>Implement the PauliNet Ansatz from <a class="reference internal" href="refs.html#hermannnc20" id="id2"><span>[HermannNC20]</span></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hamil</strong> (<em>MolecularHamiltonian</em>) – the Hamiltonian of the system.</p></li>
<li><p><strong>basis</strong> (<em>ExponentialEnvelopes</em>) – optional, the orbital
envelopes.</p></li>
<li><p><strong>confs</strong> (int, (<span class="math">\(N_\text{conf}\)</span>, <span class="math">\(N_\text{elec}\)</span>)) – optional,
specifies the electronic configuration, i.e. the occupied orbitals
in each determinant. The value of <code class="xref py py-data docutils literal notranslate"><span class="pre">confs[i,j]</span></code> is the index of
the orbital occupied by the <code class="xref py py-data docutils literal notranslate"><span class="pre">j</span></code> th electron in the <code class="xref py py-data docutils literal notranslate"><span class="pre">i</span></code> th
determinant.</p></li>
<li><p><strong>backflow_op</strong> (<em>Callable</em>) – optional, specifies how the backflow is applied
to the orbitals.</p></li>
<li><p><strong>full_determinant</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – optional, if <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, the determinants are
factorized into spin-up and spin-down parts.</p></li>
<li><p><strong>cusp_electrons</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – optional, whether to apply the electronic cusp
correction.</p></li>
<li><p><strong>cusp_alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – optional, the <span class="math">\(\alpha\)</span> factor of the electronic
cusp correction.</p></li>
<li><p><strong>backflow_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – <p>optional, specifies the type of backflow applied:</p>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'orbital'</span></code>: the same backflow is applied to an orbital in</dt><dd><p>all determinants</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'determinant'</span></code>: separate backflows are applied to each orbital in</dt><dd><p>each determinant</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>backflow_channels</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, the number of chanells of backflow.</p></li>
<li><p><strong>backflow_transform</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – <p>optional, describes the backflow transformation.
Possible values:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'mult'</span></code>: the backflow is a multiplicative factor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'add'</span></code>: the backflow is an additive term</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'both'</span></code>: the backflow consist of a multiplicative factor</dt><dd><p>and an additive term</p>
</dd>
</dl>
</li>
</ul>
</p></li>
<li><p><strong>omni_factory</strong> (<em>Callable</em>) – optional, creates the omni net.</p></li>
<li><p><strong>omni_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, extra arguments passed to
<code class="xref py py-data docutils literal notranslate"><span class="pre">omni_factory</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-deepqmc.wf.paulinet.paulinet"></span></section>
<section id="graph-neural-networks">
<h2>Graph neural networks<a class="headerlink" href="#graph-neural-networks" title="Permalink to this heading">#</a></h2>
<p>A graph neural network is the most important component of the PauliNet Ansatz.
This module implements the most useful GNNs used in deep QMC.</p>
<section id="graphs">
<h3>Graphs<a class="headerlink" href="#graphs" title="Permalink to this heading">#</a></h3>
<p>This submodule implements the basic functionality for working with (truncated) graphs.</p>
<span class="target" id="module-deepqmc.gnn.graph"></span><dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.GraphEdgeBuilder">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">GraphEdgeBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offsets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_vals</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_callback</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#GraphEdgeBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.GraphEdgeBuilder" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that builds graph edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff distance above which edges are discarded.</p></li>
<li><p><strong>mask_self</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – whether to mask edges between nodes of the same index.</p></li>
<li><p><strong>offsets</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>)</em>) – node index offset to be added to the returned
sender and receiver node indeces respectively.</p></li>
<li><p><strong>mask_vals</strong> (<em>(</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>)</em>) – if <code class="docutils literal notranslate"><span class="pre">occupancy_limit</span></code> is larger than the number
of valid edges, the remaining node indices will be filled with these
values for the sender and receiver nodes respectively
(i.e. the value to pad the node index arrays with).</p></li>
<li><p><strong>feature_callback</strong> (<em>Callable</em>) – a function that takes the sender positions,
receiver positions, sender node indeces and receiver node indeces and
returns some data (features) computed for the edges.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.GraphUpdate">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">GraphUpdate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">aggregate_edges_for_nodes_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_nodes_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_edges_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#GraphUpdate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.GraphUpdate" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that updates a graph.</p>
<p>The update function is tailored to be used in GNNs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>aggregate_edges_for_nodes_fn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – whether to perform the aggregation
of edges for nodes.</p></li>
<li><p><strong>update_nodes_fn</strong> (<em>Callable</em>) – optional, function that updates the nodes.</p></li>
<li><p><strong>update_edges_fn</strong> (<em>Callable</em>) – optional, function that updates the edges.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.MolecularGraphEdgeBuilder">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">MolecularGraphEdgeBuilder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_nuc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_up</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_down</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nuc_coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">edge_types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_by_edge_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#MolecularGraphEdgeBuilder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.MolecularGraphEdgeBuilder" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that builds many types of molecular edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_nuc</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of nuclei.</p></li>
<li><p><strong>n_up</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of spin-up electrons.</p></li>
<li><p><strong>n_down</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of spin-down electrons.</p></li>
<li><p><strong>nuc_coords</strong> (float, (<span class="math">\(N_\text{nuc}\)</span>, 3)) – coordinates of nuclei.</p></li>
<li><p><strong>edge_types</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a><em>]</em>) – <p>list of edge type names to build. Possible names are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'nn'</span></code>: nuclei-&gt;nuclei edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ne'</span></code>: nuclei-&gt;electrons edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'en'</span></code>: electrons-&gt;nuclei edges</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'same'</span></code>: edges betwen same-spin electrons</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'anti'</span></code>: edges betwen opposite-spin electrons</p></li>
</ul>
</p></li>
<li><p><strong>kwargs_by_edge_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – a mapping from names of edge types to the
kwargs to be passed to the <a class="reference internal" href="#deepqmc.gnn.graph.GraphEdgeBuilder" title="deepqmc.gnn.graph.GraphEdgeBuilder"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphEdgeBuilder</span></code></a> of that edge type.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="deepqmc.gnn.graph.difference_callback">
<span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.graph.</span></span><span class="sig-name descname"><span class="pre">difference_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos_sender</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_receiver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sender_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receiver_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/graph.html#difference_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.graph.difference_callback" title="Permalink to this definition">#</a></dt>
<dd><p>feature_callback computing the Euclidian difference vector for each edge.</p>
</dd></dl>

<span class="target" id="module-deepqmc.gnn.edge_features"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.BesselBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">BesselBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rbf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#BesselBasis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.BesselBasis" title="Permalink to this definition">#</a></dt>
<dd><p>Bessel function radial basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rbf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the number of basis functions.</p></li>
<li><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff radius for the envelope.</p></li>
<li><p><strong>envelope_factory</strong> (<em>Callable</em>) – optional, creates the distance envelope.</p></li>
<li><p><strong>kwargs</strong> – (dict): optional, kwargs for the envelope function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.CombinedRadialBases">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">CombinedRadialBases</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rbf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_rbfs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#CombinedRadialBases"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.CombinedRadialBases" title="Permalink to this definition">#</a></dt>
<dd><p>Class combining multiple radial bases.</p>
<p>The total number of basis functions
<span class="math">\(n_{rbf}\)</span> has to match the sum of the numbers of basis functions of
the constituents.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rbf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the total number of basis functions</p></li>
<li><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff radius for the radial bases</p></li>
<li><p><strong>n_rbfs</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>]</em>) – the number of basis function per basis respectively</p></li>
<li><p><strong>factories</strong> (<em>Sequence</em><em>[</em><em>Callable</em><em>]</em>) – the factories of the bases respectively</p></li>
<li><p><strong>kwargs</strong> – (Sequence[dict]): optional, kwargs for the bases respectively</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.DistancePowersBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">DistancePowersBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rbf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#DistancePowersBasis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.DistancePowersBasis" title="Permalink to this definition">#</a></dt>
<dd><p>A distance basis composed of integer powers of the distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rbf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the number of Gaussian basis functions.</p></li>
<li><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff radius for the radial bases.</p></li>
<li><p><strong>powers</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a><em>]</em>) – the powers to which the distance is raised.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – default 0.01, the numerical epsilon used for negative powers.</p></li>
<li><p><strong>envelope_factory</strong> (<em>Callable</em>) – optional, a function returning an instance of
<a class="reference internal" href="#deepqmc.gnn.edge_features.Envelope" title="deepqmc.gnn.edge_features.Envelope"><code class="xref py py-class docutils literal notranslate"><span class="pre">Envelope</span></code></a>.</p></li>
<li><p><strong>envelope_kwargs</strong> – (dict): optional, kwargs for the envelope factory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.EdgeFeatures">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">EdgeFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rbf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">irreps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence" title="(in Python v3.11)"><span class="pre">Sequence</span></a><span class="p"><span class="pre">[</span></span><span class="pre">e3nn_jax.Irrep</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">equivariant</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">combine_idxs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">separate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_basis_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_basis_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#EdgeFeatures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.EdgeFeatures" title="Permalink to this definition">#</a></dt>
<dd><p>Class combining the radial and angular bases to obtain edge features.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rbf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the number of radial basis functions</p></li>
<li><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff radius for the radial basis</p></li>
<li><p><strong>irreps</strong> (<em>Sequence</em><em>[</em><em>e3nn_jax.Irrep</em><em>]</em>) – the irreducible representations for
the angular basis</p></li>
<li><p><strong>separate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – default <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, whether to keep radial and angular
parts separate.</p></li>
<li><p><strong>equivariant</strong> – default True, if False the distinction between feature
dimension and irreps dimension is removed</p></li>
<li><p><strong>radial_basis_factory</strong> (<em>Callable</em>) – optional, creates the radial basis</p></li>
<li><p><strong>radial_basis_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, kwargs for the radial basis</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.Envelope">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">Envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#Envelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.Envelope" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for the radial envelopes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff distance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.GaussianBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">GaussianBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rbf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#GaussianBasis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.GaussianBasis" title="Permalink to this definition">#</a></dt>
<dd><p>Gaussian distance basis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rbf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the number of Gaussian basis functions.</p></li>
<li><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff radius for the radial bases.</p></li>
<li><p><strong>offset</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – default <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-data docutils literal notranslate"><span class="pre">False</span></code></a>, whether to offset the first Gaussian
from zero.</p></li>
<li><p><strong>envelope_factory</strong> (<em>Callable</em>) – optional, a function returning an instance of
<a class="reference internal" href="#deepqmc.gnn.edge_features.Envelope" title="deepqmc.gnn.edge_features.Envelope"><code class="xref py py-class docutils literal notranslate"><span class="pre">Envelope</span></code></a>.</p></li>
<li><p><strong>envelope_kwargs</strong> – (dict): optional, kwargs for the envelope factory.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.IdentityEnvelope">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">IdentityEnvelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#IdentityEnvelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.IdentityEnvelope" title="Permalink to this definition">#</a></dt>
<dd><p>The identity envelope.</p>
<p>The value of the envelope is one below the cutoff distance and zero above it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff distance.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.PauliNetEdgeFeatures">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">PauliNetEdgeFeatures</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">powers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">difference</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_factory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#PauliNetEdgeFeatures"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.PauliNetEdgeFeatures" title="Permalink to this definition">#</a></dt>
<dd><p>Utility class to retain the old edge feature interface.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.PolynomialEnvelope">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">PolynomialEnvelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r_cut</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><span class="pre">float</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n0</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">n1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#PolynomialEnvelope"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.PolynomialEnvelope" title="Permalink to this definition">#</a></dt>
<dd><p>A polynomial envelope with custom derivative properties at zero and the cutoff.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff distance.</p></li>
<li><p><strong>n0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the first <code class="xref py py-data docutils literal notranslate"><span class="pre">n0</span></code> derivatives will be zero at the origin.</p></li>
<li><p><strong>n1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the first <code class="xref py py-data docutils literal notranslate"><span class="pre">n1</span></code> derivatives will be zero at the cutoff.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.edge_features.RadialBasis">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.edge_features.</span></span><span class="sig-name descname"><span class="pre">RadialBasis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_rbf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_cut</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_factory</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envelope_kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.11)"><span class="pre">Optional</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><span class="pre">dict</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/edge_features.html#RadialBasis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.edge_features.RadialBasis" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for the radial bases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_rbf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the number of basis functions.</p></li>
<li><p><strong>r_cut</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – the cutoff radius for the envelope.</p></li>
<li><p><strong>envelope_factory</strong> (<em>Callable</em>) – optional, creates the distance envelope.</p></li>
<li><p><strong>kwargs</strong> – (dict): optional, kwargs for the envelope function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="gnns">
<h3>GNNs<a class="headerlink" href="#gnns" title="Permalink to this heading">#</a></h3>
<p>This submodule provides the base classes that all GNN instances should inherit from.</p>
<span class="target" id="module-deepqmc.gnn.gnn"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.GraphNeuralNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.gnn.</span></span><span class="sig-name descname"><span class="pre">GraphNeuralNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#GraphNeuralNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.GraphNeuralNetwork" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all graph neural networks on molecules.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">deepqmc.jax.Molecule</span></code>) – the molecule on which the GNN
is defined</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the size of the electron embeddings to be returned.</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a>) – cutoff distance above which graph edges are discarded.</p></li>
<li><p><strong>n_interactions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the number of interaction layers in the GNN.</p></li>
<li><p><strong>layer_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, kwargs to be passed to the layers.</p></li>
<li><p><strong>ghost_coords</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>[</em><em>N</em><em>, </em><em>3</em><em>]</em>) – optional, coordinates of ghost atoms.
These will be included as nuclear nodes in the graph. Useful for
breaking undesired spatial symmetries.</p></li>
<li><p><strong>share_with_layers</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, attribute names and values to share
with the interaction layers.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.GraphNeuralNetwork.edge_factory">
<span class="sig-name descname"><span class="pre">edge_factory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">r</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupancies</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#GraphNeuralNetwork.edge_factory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.GraphNeuralNetwork.edge_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Return a function that builds all the edges used in the GNN.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.GraphNeuralNetwork.edge_feature_callback">
<span class="sig-name descname"><span class="pre">edge_feature_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">edge_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_sender</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pos_receiver</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sender_idx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">receiver_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#GraphNeuralNetwork.edge_feature_callback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.GraphNeuralNetwork.edge_feature_callback" title="Permalink to this definition">#</a></dt>
<dd><p>Define the <code class="xref py py-func docutils literal notranslate"><span class="pre">feature_callback()</span></code> for the different types of edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>edge_typ</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)"><em>str</em></a>) – name of the edge_type for which features are calculated.</p></li>
<li><p><strong>pos_sender</strong> (float, (<span class="math">\(N_\text{nodes}\)</span>, 3)) – coordinates of the
sender nodes.</p></li>
<li><p><strong>pos_receiver</strong> (float, (<span class="math">\(M_\text{nodes}\)</span>, 3]) – coordinates of the
receiver nodes.</p></li>
<li><p><strong>sender_idx</strong> (int, (<code class="xref py py-data docutils literal notranslate"><span class="pre">occupancy_limit</span></code>)) – indeces of the sender nodes.</p></li>
<li><p><strong>receiver_idx</strong> (int, (<code class="xref py py-data docutils literal notranslate"><span class="pre">occupancy_limit</span></code>)) – indeces of the receiver
nodes.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the features for the given edges</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.GraphNeuralNetwork.edge_types">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">edge_types</span></span><a class="headerlink" href="#deepqmc.gnn.gnn.GraphNeuralNetwork.edge_types" title="Permalink to this definition">#</a></dt>
<dd><p>Return a tuple containing the names of the edge types used in the GNN.</p>
<p>See <code class="xref py py-class docutils literal notranslate"><span class="pre">MolecularGraphEdgeBuilder</span></code> for possible
edge types.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.GraphNeuralNetwork.init_state">
<span class="sig-name descname"><span class="pre">init_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#GraphNeuralNetwork.init_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.GraphNeuralNetwork.init_state" title="Permalink to this definition">#</a></dt>
<dd><p>Initialize the haiku state that communicates the sizes of edge lists.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.GraphNeuralNetwork.layer_class">
<em class="property"><span class="pre">class</span><span class="w"> </span><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">layer_class</span></span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#GraphNeuralNetwork.layer_class"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.GraphNeuralNetwork.layer_class" title="Permalink to this definition">#</a></dt>
<dd><p>Return the class of the interaction layer to be used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.GraphNeuralNetwork.node_factory">
<span class="sig-name descname"><span class="pre">node_factory</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#GraphNeuralNetwork.node_factory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.GraphNeuralNetwork.node_factory" title="Permalink to this definition">#</a></dt>
<dd><p>Return the initial node representation as a <code class="xref py py-class docutils literal notranslate"><span class="pre">GraphNodes</span></code> instance.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.GraphNeuralNetwork.process_final_embedding">
<span class="sig-name descname"><span class="pre">process_final_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">final_embedding</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#GraphNeuralNetwork.process_final_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.GraphNeuralNetwork.process_final_embedding" title="Permalink to this definition">#</a></dt>
<dd><p>Process final embedding produced by last layer.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.MessagePassingLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.gnn.</span></span><span class="sig-name descname"><span class="pre">MessagePassingLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#MessagePassingLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.MessagePassingLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Base class for all message passing layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ilayer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the index of the current layer in the list of all layers</p></li>
<li><p><strong>shared</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – attribute names and values which are shared between the
layers and the <a class="reference internal" href="#deepqmc.gnn.gnn.GraphNeuralNetwork" title="deepqmc.gnn.gnn.GraphNeuralNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphNeuralNetwork</span></code></a> instance.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.MessagePassingLayer.get_aggregate_edges_for_nodes_fn">
<span class="sig-name descname"><span class="pre">get_aggregate_edges_for_nodes_fn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#MessagePassingLayer.get_aggregate_edges_for_nodes_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.MessagePassingLayer.get_aggregate_edges_for_nodes_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that aggregates the graph edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a function
that outputs the aggregated edges.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable[GraphNodes,GraphEdges]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.MessagePassingLayer.get_update_edges_fn">
<span class="sig-name descname"><span class="pre">get_update_edges_fn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#MessagePassingLayer.get_update_edges_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.MessagePassingLayer.get_update_edges_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that updates the graph edges.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a function
that outputs the updated edges as a <code class="xref py py-class docutils literal notranslate"><span class="pre">GraphEdges</span></code> instance.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable[GraphNodes,GraphEdges]</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="deepqmc.gnn.gnn.MessagePassingLayer.get_update_nodes_fn">
<span class="sig-name descname"><span class="pre">get_update_nodes_fn</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/gnn.html#MessagePassingLayer.get_update_nodes_fn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.gnn.MessagePassingLayer.get_update_nodes_fn" title="Permalink to this definition">#</a></dt>
<dd><p>Create a function that updates the graph nodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>a function
that outputs the updated nodes as a <code class="xref py py-class docutils literal notranslate"><span class="pre">GraphNodes</span></code> instance.
The second argument will be the aggregated graph edges.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable[GraphNodes,*]</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="schnet">
<h3>SchNet<a class="headerlink" href="#schnet" title="Permalink to this heading">#</a></h3>
<p>This submodule defines the SchNet architecutre adapted for graphs of nuclei and electrons.</p>
<span class="target" id="module-deepqmc.gnn.schnet"></span><dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.schnet.SchNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.schnet.</span></span><span class="sig-name descname"><span class="pre">SchNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/schnet.html#SchNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.schnet.SchNet" title="Permalink to this definition">#</a></dt>
<dd><p>The SchNet architecture <a class="reference internal" href="refs.html#schuettjcp18" id="id3"><span>[SchuettJCP18]</span></a> adapted for graphs of nuclei and electrons.</p>
<p>Derived from <a class="reference internal" href="#deepqmc.gnn.gnn.GraphNeuralNetwork" title="deepqmc.gnn.gnn.GraphNeuralNetwork"><code class="xref py py-class docutils literal notranslate"><span class="pre">GraphNeuralNetwork</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>Molecule</em>) – the molecule on which the graph is defined.</p></li>
<li><p><strong>embedding_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the length of the electron embedding vectors.</p></li>
<li><p><strong>cutoff</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.11)"><em>float</em></a><em>, </em><em>a.u.</em>) – the distance cutoff beyond which interactions
are discarded.</p></li>
<li><p><strong>n_interactions</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – number of message passing interactions.</p></li>
<li><p><strong>edge_feat_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – extra arguments passed to
<code class="xref py py-class docutils literal notranslate"><span class="pre">EdgeFeatures</span></code>.</p></li>
<li><p><strong>edge_feat_kwargs_by_typ</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – extra arguments passed to
<code class="xref py py-class docutils literal notranslate"><span class="pre">EdgeFeatures</span></code>, specified
indepenedently for different edge types.</p></li>
<li><p><strong>kernel_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – size of the kernel vectors.</p></li>
<li><p><strong>fix_init_emb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – whether to use a fixed initial embedding for the
electrons or to use <code class="xref py py-class docutils literal notranslate"><span class="pre">hk.Embed</span></code>.</p></li>
<li><p><strong>gnn_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – extra arguments passed to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">GraphNeuralNetwork</span></code> base class.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="deepqmc.gnn.schnet.SchNetLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">deepqmc.gnn.schnet.</span></span><span class="sig-name descname"><span class="pre">SchNetLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)"><span class="pre">Any</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/deepqmc/gnn/schnet.html#SchNetLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#deepqmc.gnn.schnet.SchNetLayer" title="Permalink to this definition">#</a></dt>
<dd><p>The message passing layer of <a class="reference internal" href="#deepqmc.gnn.schnet.SchNet" title="deepqmc.gnn.schnet.SchNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchNet</span></code></a>.</p>
<p>Derived from <a class="reference internal" href="#deepqmc.gnn.gnn.MessagePassingLayer" title="deepqmc.gnn.gnn.MessagePassingLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">MessagePassingLayer</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ilayer</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – the index of the current layer in the list of all layers</p></li>
<li><p><strong>shared</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – attribute names and values which are shared between the
layers and the <a class="reference internal" href="#deepqmc.gnn.schnet.SchNet" title="deepqmc.gnn.schnet.SchNet"><code class="xref py py-class docutils literal notranslate"><span class="pre">SchNet</span></code></a> instance.</p></li>
<li><p><strong>shared_h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – optional, whether to use a shared <code class="xref py py-data docutils literal notranslate"><span class="pre">h</span></code> subnetwork.</p></li>
<li><p><strong>shared_g</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)"><em>bool</em></a>) – optional, whether to use a shared <code class="xref py py-data docutils literal notranslate"><span class="pre">g</span></code> subnetwork.</p></li>
<li><p><strong>n_layers_w</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, the number of layers in the <code class="xref py py-data docutils literal notranslate"><span class="pre">w</span></code>
subnetwork.</p></li>
<li><p><strong>n_layers_h</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, the number of layers in the <code class="xref py py-data docutils literal notranslate"><span class="pre">h</span></code>
subnetwork.</p></li>
<li><p><strong>n_layers_g</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)"><em>int</em></a>) – optional, the number of layers in the <code class="xref py py-data docutils literal notranslate"><span class="pre">g</span></code>
subnetwork.</p></li>
<li><p><strong>subnet_kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, extra arguments passed to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">MLP</span></code> constructor of the subnetworks.</p></li>
<li><p><strong>subnet_kwargs_by_lbl</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.11)"><em>dict</em></a>) – optional, extra arguments passed to the
<code class="xref py py-class docutils literal notranslate"><span class="pre">MLP</span></code> constructor of the subnetworks. Arguments
can be specified independently for each subnet
(<code class="xref py py-data docutils literal notranslate"><span class="pre">w</span></code>, <code class="xref py py-data docutils literal notranslate"><span class="pre">h</span></code> or <code class="xref py py-data docutils literal notranslate"><span class="pre">g</span></code>).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</section>
</section>
</section>


            </article>
            
            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="cli.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">Command-line interface</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="refs.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">References</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
          </div>
        </footer>
        
      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  <footer class="bd-footer"><div class="bd-footer__inner container">
  
  <div class="footer-item">
    
<p class="copyright">

    &copy; Copyright 2019-2022, Frank Noé and collaborators.<br>

</p>

  </div>
  
  <div class="footer-item">
    
<p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.3.0.<br>
</p>

  </div>
  
  <div class="footer-item">
    <p class="theme-version">
    Built with the
    <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">
        PyData Sphinx Theme
    </a>
    0.12.0.
</p>
  </div>
  
  <div class="footer-item">
    
<div class="tocsection sourcelink">
    <a href="_sources/api.rst.txt">
        <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
</div>

  </div>
  
</div>
  </footer>
  </body>
</html>